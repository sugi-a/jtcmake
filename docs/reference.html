<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; JTCMake  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="JTCMake Tutorial" href="howto.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> JTCMake
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="howto.html">JTCMake Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#jtcmake.StaticGroupBase"><code class="docutils literal notranslate"><span class="pre">StaticGroupBase</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.StaticGroupBase.__init__"><code class="docutils literal notranslate"><span class="pre">StaticGroupBase.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.StaticGroupBase.clean"><code class="docutils literal notranslate"><span class="pre">StaticGroupBase.clean()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.StaticGroupBase.groups"><code class="docutils literal notranslate"><span class="pre">StaticGroupBase.groups</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.StaticGroupBase.make"><code class="docutils literal notranslate"><span class="pre">StaticGroupBase.make()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.StaticGroupBase.prefix"><code class="docutils literal notranslate"><span class="pre">StaticGroupBase.prefix</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.StaticGroupBase.rules"><code class="docutils literal notranslate"><span class="pre">StaticGroupBase.rules</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.StaticGroupBase.select_files"><code class="docutils literal notranslate"><span class="pre">StaticGroupBase.select_files()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.StaticGroupBase.select_groups"><code class="docutils literal notranslate"><span class="pre">StaticGroupBase.select_groups()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.StaticGroupBase.select_rules"><code class="docutils literal notranslate"><span class="pre">StaticGroupBase.select_rules()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.StaticGroupBase.set_prefix"><code class="docutils literal notranslate"><span class="pre">StaticGroupBase.set_prefix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.StaticGroupBase.touch"><code class="docutils literal notranslate"><span class="pre">StaticGroupBase.touch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#jtcmake.GroupsGroup"><code class="docutils literal notranslate"><span class="pre">GroupsGroup</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.__init__"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.add_group"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.add_group()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.clean"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.clean()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.groups"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.groups</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.make"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.make()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.prefix"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.prefix</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.rules"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.rules</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.select_files"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.select_files()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.select_groups"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.select_groups()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.select_rules"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.select_rules()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.set_default_child"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.set_default_child()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.set_prefix"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.set_prefix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.set_props"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.set_props()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.GroupsGroup.touch"><code class="docutils literal notranslate"><span class="pre">GroupsGroup.touch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#jtcmake.RulesGroup"><code class="docutils literal notranslate"><span class="pre">RulesGroup</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.__init__"><code class="docutils literal notranslate"><span class="pre">RulesGroup.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.add"><code class="docutils literal notranslate"><span class="pre">RulesGroup.add()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.add_deco"><code class="docutils literal notranslate"><span class="pre">RulesGroup.add_deco()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.addvf"><code class="docutils literal notranslate"><span class="pre">RulesGroup.addvf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.addvf_deco"><code class="docutils literal notranslate"><span class="pre">RulesGroup.addvf_deco()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.clean"><code class="docutils literal notranslate"><span class="pre">RulesGroup.clean()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.groups"><code class="docutils literal notranslate"><span class="pre">RulesGroup.groups</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.make"><code class="docutils literal notranslate"><span class="pre">RulesGroup.make()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.prefix"><code class="docutils literal notranslate"><span class="pre">RulesGroup.prefix</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.rules"><code class="docutils literal notranslate"><span class="pre">RulesGroup.rules</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.select_files"><code class="docutils literal notranslate"><span class="pre">RulesGroup.select_files()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.select_groups"><code class="docutils literal notranslate"><span class="pre">RulesGroup.select_groups()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.select_rules"><code class="docutils literal notranslate"><span class="pre">RulesGroup.select_rules()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.set_prefix"><code class="docutils literal notranslate"><span class="pre">RulesGroup.set_prefix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.RulesGroup.touch"><code class="docutils literal notranslate"><span class="pre">RulesGroup.touch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#jtcmake.UntypedGroup"><code class="docutils literal notranslate"><span class="pre">UntypedGroup</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.__init__"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.add"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.add()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.add_deco"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.add_deco()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.add_group"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.add_group()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.addvf"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.addvf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.addvf_deco"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.addvf_deco()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.clean"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.clean()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.groups"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.groups</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.make"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.make()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.prefix"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.prefix</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.rules"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.rules</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.select_files"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.select_files()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.select_groups"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.select_groups()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.select_rules"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.select_rules()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.set_prefix"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.set_prefix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.UntypedGroup.touch"><code class="docutils literal notranslate"><span class="pre">UntypedGroup.touch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#jtcmake.Rule"><code class="docutils literal notranslate"><span class="pre">Rule</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.Rule.clean"><code class="docutils literal notranslate"><span class="pre">Rule.clean()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.Rule.files"><code class="docutils literal notranslate"><span class="pre">Rule.files</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.Rule.init"><code class="docutils literal notranslate"><span class="pre">Rule.init()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.Rule.init_deco"><code class="docutils literal notranslate"><span class="pre">Rule.init_deco()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.Rule.initvf"><code class="docutils literal notranslate"><span class="pre">Rule.initvf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.Rule.initvf_deco"><code class="docutils literal notranslate"><span class="pre">Rule.initvf_deco()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.Rule.touch"><code class="docutils literal notranslate"><span class="pre">Rule.touch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#jtcmake.Rule.xfiles"><code class="docutils literal notranslate"><span class="pre">Rule.xfiles</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#jtcmake.File"><code class="docutils literal notranslate"><span class="pre">File</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#jtcmake.VFile"><code class="docutils literal notranslate"><span class="pre">VFile</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#jtcmake.IFile"><code class="docutils literal notranslate"><span class="pre">IFile</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#jtcmake.make"><code class="docutils literal notranslate"><span class="pre">make()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#jtcmake.print_graphviz"><code class="docutils literal notranslate"><span class="pre">print_graphviz()</span></code></a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">JTCMake</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/reference.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="jtcmake.StaticGroupBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jtcmake.</span></span><span class="sig-name descname"><span class="pre">StaticGroupBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglevel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'debug'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'info'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'warning'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'error'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_default_logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jtcmake.StaticGroupBase" title="Permalink to this definition"></a></dt>
<dd><p>Base class for static groups.</p>
<p>A static group should be defined by subclassing StaticGroupBase.
It must have type annotations to represent its child groups and rules.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CustomStaticGroup</span><span class="p">(</span><span class="n">StaticGroupBase</span><span class="p">):</span>
    <span class="n">child_rule1</span><span class="p">:</span> <span class="n">Rule</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">child_rule2</span><span class="p">:</span> <span class="n">Rule</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]]</span>
    <span class="n">child_group1</span><span class="p">:</span> <span class="n">AnotherStaticGroup</span>
    <span class="n">child_group2</span><span class="p">:</span> <span class="n">RulesGroup</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Generic type parameters like ``[str]`` in this example is ignored</span>
<span class="sd">    at runtime. They are just hints for the type checker and IDE.</span>
<span class="sd">    &#39;&#39;&#39;</span>
</pre></div>
</div>
<p>The child nodes are automatically instanciated when the parent is
instanciated. So you can read them without assigning values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">CustomStaticGroup</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">child_rule1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">child_group1</span><span class="p">)</span>
</pre></div>
</div>
<p>Remember that the child rules are automatically instanciated but not
<em>initialized</em> . you have to manually initialize them with
<code class="docutils literal notranslate"><span class="pre">Rule.init</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">child_rule1</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;child_file1.txt&quot;</span><span class="p">,</span> <span class="n">copy</span><span class="p">)(</span><span class="n">souce_file</span><span class="p">,</span> <span class="n">SELF</span><span class="p">)</span>
</pre></div>
</div>
<p>As a design pattern, it is recommended to have an initializer method
that initializes the child rules and calls the initializer of the child
groups to recursively initialize all the rules in the sub-tree.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">StaticGroupBase</span><span class="p">,</span> <span class="n">Rule</span><span class="p">,</span> <span class="n">SELF</span>


<span class="k">class</span> <span class="nc">MyGroup</span><span class="p">(</span><span class="n">StaticGroupBase</span><span class="p">):</span>
    <span class="vm">__globals__</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span>  <span class="c1"># For Sphinx&#39;s doctest. Not necessary in normal situations.</span>
    <span class="n">child_rule</span><span class="p">:</span> <span class="n">Rule</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">child_group</span><span class="p">:</span> <span class="n">MyChildGroup</span>

    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">repeat</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MyGroup</span><span class="p">:</span>
        <span class="c1"># Initializer for this class. The method name &quot;init&quot; is not</span>
        <span class="c1"># reserved so you can choose your own one.</span>

        <span class="c1"># Initialize the direct child rules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">child_rule</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;&lt;R&gt;.txt&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">write_text</span><span class="p">)(</span><span class="n">SELF</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

        <span class="c1"># Initialize the child group</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">child_group</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">child_rule</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">repeat</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>


<span class="k">class</span> <span class="nc">MyChildGroup</span><span class="p">(</span><span class="n">StaticGroupBase</span><span class="p">):</span>
    <span class="vm">__globals__</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span>  <span class="c1"># For Sphinx&#39;s doctest. Not necessary in normal situations.</span>
    <span class="n">foo</span><span class="p">:</span> <span class="n">Rule</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">repeat</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MyChildGroup</span><span class="p">:</span>
        <span class="nd">@self</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">init_deco</span><span class="p">(</span><span class="s2">&quot;&lt;R&gt;.txt&quot;</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">SELF</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="n">repeat</span><span class="p">):</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
            <span class="n">dst</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span> <span class="o">*</span> <span class="n">repeat</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>


<span class="n">g</span> <span class="o">=</span> <span class="n">MyGroup</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/child_rule.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abc&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/child_group/foo.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abcabc&quot;</span>

<span class="kn">import</span> <span class="nn">shutil</span><span class="p">;</span> <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>  <span class="c1"># Cleanup for Sphinx&#39;s doctest</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When you override the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method, you have to call
<code class="docutils literal notranslate"><span class="pre">super().__init__</span></code> in it with appropriate arguments.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.StaticGroupBase.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglevel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'debug'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'info'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'warning'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'error'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_default_logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jtcmake.StaticGroupBase.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>driname</strong> – directory name of this group.
<code class="docutils literal notranslate"><span class="pre">dirname=&quot;foo&quot;</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">prefix=&quot;foo/&quot;</span></code></p></li>
<li><p><strong>prefix</strong> – path prefix of this group.
You may not specify <code class="docutils literal notranslate"><span class="pre">dirname</span></code> and <code class="docutils literal notranslate"><span class="pre">prefix</span></code> at the same time.
If both <code class="docutils literal notranslate"><span class="pre">dirname</span></code> and <code class="docutils literal notranslate"><span class="pre">prefix</span></code> is none, prefix will be “”</p></li>
<li><p><strong>use_default_logger</strong> – if True, logs will be printed to stderr or
displayed as HTML if the code is running on Jupyter Notebook.</p></li>
<li><p><strong>logfile</strong> – str, PathLike, Logger, object with a <code class="docutils literal notranslate"><span class="pre">write(str)</span></code> method,
or list/tuple of them, indicating the target(s) to which logs
should be output.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.StaticGroupBase.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#jtcmake.StaticGroupBase.clean" title="Permalink to this definition"></a></dt>
<dd><p>Delete all the existing files of this group.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.StaticGroupBase.groups">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">groups</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">IGroup</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jtcmake.StaticGroupBase.groups" title="Permalink to this definition"></a></dt>
<dd><p>Readonly dictionary of child groups.</p>
<ul class="simple">
<li><p>Key: base name of the child group</p></li>
<li><p>Value: child group node object</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.StaticGroupBase.make">
<span class="sig-name descname"><span class="pre">make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dry_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_going</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">njobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MakeSummary</span></span></span><a class="headerlink" href="#jtcmake.StaticGroupBase.make" title="Permalink to this definition"></a></dt>
<dd><p>Make rules in this group and their dependencies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dry_run</strong> (<em>bool</em>) – instead of actually excuting the methods,
print expected execution logs.</p></li>
<li><p><strong>keep_going</strong> (<em>bool</em>) – If False (default), stop everything when a rule fails.
If True, when a rule fails, keep executing other rules
except the ones depend on the failed rule.</p></li>
<li><p><strong>njobs</strong> (<em>int</em>) – Maximum number of rules that can be made simultaneously using
multiple threads and processes.
Defaults to 1 (single process, single thread).</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See the description of jtcmake.make for more detail of njobs</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.StaticGroupBase.prefix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prefix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#jtcmake.StaticGroupBase.prefix" title="Permalink to this definition"></a></dt>
<dd><p>Path prefix of this group.</p>
<dl class="simple">
<dt>Seealso:</dt><dd><p><a class="reference internal" href="#jtcmake.StaticGroupBase.set_prefix" title="jtcmake.StaticGroupBase.set_prefix"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_prefix()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.StaticGroupBase.rules">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rules</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jtcmake.Rule" title="jtcmake.group_tree.rule.Rule"><span class="pre">Rule</span></a><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jtcmake.StaticGroupBase.rules" title="Permalink to this definition"></a></dt>
<dd><p>Readonly dictionary of child rules.</p>
<ul class="simple">
<li><p>Key: base name of the child rule</p></li>
<li><p>Value: child rule node object</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.StaticGroupBase.select_files">
<span class="sig-name descname"><span class="pre">select_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jtcmake.IFile" title="jtcmake.group_tree.core.IFile"><span class="pre">IFile</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.StaticGroupBase.select_files" title="Permalink to this definition"></a></dt>
<dd><p>Create list of files in this group sub-tree that match <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.</p>
<p>This is the file-version of <a class="reference internal" href="#jtcmake.StaticGroupBase.select_groups" title="jtcmake.StaticGroupBase.select_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">select_groups()</span></code></a>.
See its documentation for detail.</p>
<p class="rubric">Examples</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;ROOT&gt;
|-- a(r)
|   |-- a (f:a.txt)
|   `-- b (f:b.html)
|
`-- b(g)
    `-- a(r)
        `-- a (f:a.txt)
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span><span class="p">,</span> <span class="n">SELF</span>

<span class="c1"># Building the above group tree</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">()</span>  <span class="c1"># Root group</span>
<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;a.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="s2">&quot;b.html&quot;</span> <span class="p">},</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">SELF</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;a.txt&quot;</span> <span class="p">},</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_files</span><span class="p">(</span><span class="s2">&quot;**/a&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">a</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_files</span><span class="p">(</span><span class="s2">&quot;a/*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">b</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.StaticGroupBase.select_groups">
<span class="sig-name descname"><span class="pre">select_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">IGroup</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.StaticGroupBase.select_groups" title="Permalink to this definition"></a></dt>
<dd><p>Create list of groups in this group sub-tree that match <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.
The list may include this group itself.</p>
<p>Groups are gathered based on the given pattern in a manner similar to
how we specify a set of files using a glob pattern on Unix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pattern</strong> – <p>str or list/tuple of str representing a pattern of
relative names of offspring nodes.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">pattern</span></code> is a list/tuple of strs,
it must be a sequence of <em>base name patterns</em> like
<code class="docutils literal notranslate"><span class="pre">[&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;]</span></code> or <code class="docutils literal notranslate"><span class="pre">[&quot;a&quot;,</span> <span class="pre">&quot;*b*&quot;,</span> <span class="pre">&quot;c&quot;,</span> <span class="pre">&quot;**&quot;]</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">pattern</span></code> is a str, it will be internally translated into
an equivalent list-of-str pattern by splitting it with <code class="docutils literal notranslate"><span class="pre">/</span></code>.
So, for example, <code class="docutils literal notranslate"><span class="pre">g.select_groups(&quot;a/b/c&quot;)</span> <span class="pre">is</span> <span class="pre">equivalent</span> <span class="pre">to</span>
<span class="pre">``g.select_groups([&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;])</span></code>.</p>
</p>
</dd>
</dl>
<p>Suppose we have the following group tree (the tree may have rules as
well but we omit them since this method collects groups only).</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;ROOT&gt;
|
|-- a1
|   |-- b1
|   `-- b2
|       `-- c1
|
|-- a2
|   `-- b1
|
`-- a1/b1
</pre></div>
</div>
<p>We use a list of strs to identify each group node.
For example, the (absolute) name of the forth group from the top
(the deepest one) is <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;,</span> <span class="pre">&quot;b2&quot;,</span> <span class="pre">&quot;c1&quot;]</span></code>.
Its <em>relative name</em> with respect to the group <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;]</span></code> is
<code class="docutils literal notranslate"><span class="pre">[&quot;b2&quot;,</span> <span class="pre">&quot;c1&quot;]</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;c1&quot;</span></code> is its <em>base name</em>.</p>
<p>Pattern matching is basically as simple as <em>pattern</em> <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;,</span> <span class="pre">&quot;b1&quot;]</span></code>
matches the <em>relative name</em> <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;,</span> <span class="pre">&quot;b1&quot;]</span></code>.
Additionally, you can use wildcard <code class="docutils literal notranslate"><span class="pre">*</span></code> in patterns as follows.</p>
<ul class="simple">
<li><p>Double stars <code class="docutils literal notranslate"><span class="pre">**</span></code> can appear as a special base name indicating
zero or more repetition of arbitrary base names.
It may NOT appear inside a base name like <code class="docutils literal notranslate"><span class="pre">a/**b/c</span></code></p></li>
<li><p>Single stars <code class="docutils literal notranslate"><span class="pre">*</span></code> can appear inside a base name indicating zero
or more repetition of arbitrary character.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span>

<span class="c1"># Building the above group tree</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">()</span>  <span class="c1"># Root group</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b2&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;c1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a2&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">([</span><span class="s2">&quot;a1&quot;</span><span class="p">,</span> <span class="s2">&quot;b1&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">]</span>

<span class="c1"># In the following example,  ``/`` in the base name is treated</span>
<span class="c1"># as a normal character and has no effect as a base name boundary</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">([</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">]]</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;a*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">]]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;*/*1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">b1</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;**/*1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">c1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">]</span>
<span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;**&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span>
    <span class="n">g</span><span class="p">,</span>  <span class="c1"># root is included</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">c1</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span>
    <span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">],</span>
<span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;a1/*&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Current implementation collects nodes using pre-order DFS but
it may be changed in the future.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.StaticGroupBase.select_rules">
<span class="sig-name descname"><span class="pre">select_rules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">IRule</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.StaticGroupBase.select_rules" title="Permalink to this definition"></a></dt>
<dd><p>Create list of rules in this group sub-tree that match <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.</p>
<p>This is the rule-version of <a class="reference internal" href="#jtcmake.StaticGroupBase.select_groups" title="jtcmake.StaticGroupBase.select_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">select_groups()</span></code></a>.
See its documentation for detail.</p>
<p class="rubric">Examples</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;ROOT&gt;
|-- a0(r)
|-- a1
|   `-- a2(r)
`-- a3
    `-- a4(r)
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span><span class="p">,</span> <span class="n">SELF</span>

<span class="c1"># Building the above group tree</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">()</span>  <span class="c1"># Root group</span>
<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a0&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a2&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a3&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a4&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_rules</span><span class="p">(</span><span class="s2">&quot;a*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a0</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_rules</span><span class="p">(</span><span class="s2">&quot;*/a*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">a4</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.StaticGroupBase.set_prefix">
<span class="sig-name descname"><span class="pre">set_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">T_Self</span></span></span><a class="headerlink" href="#jtcmake.StaticGroupBase.set_prefix" title="Permalink to this definition"></a></dt>
<dd><p>Set the path prefix of this group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dirname</strong> – if specified, prefix will be <code class="docutils literal notranslate"><span class="pre">dirname</span> <span class="pre">+</span> <span class="pre">&quot;/&quot;</span></code></p></li>
<li><p><strong>prefix</strong> – path prefix.</p></li>
</ul>
</dd>
</dl>
<p>You must specify either but not both of <code class="docutils literal notranslate"><span class="pre">dirname</span></code> or <code class="docutils literal notranslate"><span class="pre">prefix</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">self.set_prefix(&quot;a&quot;)</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">self.set_prefix(prefix=&quot;a/&quot;)</span></code>.</p>
<p>If this group is not the root group and the given prefix is a
relative path, the path prefix of the parent group will be added to
its start. Absolute paths do not undergo this prefixing.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method may be called only when the prefix is not yet
determined. i.e. You may NOT call this method whenever,</p>
<ul class="simple">
<li><p>You have created this group as a root group</p></li>
<li><p>You have once called it</p></li>
<li><p>You have once read <a class="reference internal" href="#jtcmake.StaticGroupBase.prefix" title="jtcmake.StaticGroupBase.prefix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">self.prefix</span></code></a>:
reading <a class="reference internal" href="#jtcmake.StaticGroupBase.prefix" title="jtcmake.StaticGroupBase.prefix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">self.prefix</span></code></a> internally finalizes
the prefix to <code class="docutils literal notranslate"><span class="pre">&quot;{name</span> <span class="pre">of</span> <span class="pre">this</span> <span class="pre">group}/&quot;</span></code></p></li>
<li><p>You have once read the prefix of a child group:
reading a child’s prefix internally reads the parent’s prefix</p></li>
<li><p>You have initialized any rule in the sub-tree:
initializing a rule internally reads its parent’s prefix</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># (For Unix only)</span>

<span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">(</span><span class="s2">&quot;root&quot;</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_prefix</span><span class="p">(</span><span class="s2">&quot;foo-dir&quot;</span><span class="p">)</span>  <span class="c1"># dirname</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;bar-&quot;</span><span class="p">)</span>  <span class="c1"># prefix</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;baz&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_prefix</span><span class="p">(</span><span class="s2">&quot;/tmp/baz&quot;</span><span class="p">)</span>  <span class="c1"># dirname abspath</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;qux&quot;</span><span class="p">)</span>  <span class="c1"># no explicit setting</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/foo-dir/&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/bar-&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">baz</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;/tmp/baz/&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">qux</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/qux/&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.StaticGroupBase.touch">
<span class="sig-name descname"><span class="pre">touch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#jtcmake.StaticGroupBase.touch" title="Permalink to this definition"></a></dt>
<dd><p>For every rule in the group, touch (set mtime to now) the output files
and force the memo to record the current input state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>bool</em>) – if False, files won’t be touched. Defaults to True.</p></li>
<li><p><strong>memo</strong> (<em>bool</em>) – if False, memos won’t be modified. Defaults to True.</p></li>
<li><p><strong>create</strong> (<em>bool</em>) – if True, missing files will be created. Otherwise,
only the existing files will be touched.
This option has no effect with <code class="docutils literal notranslate"><span class="pre">file=False</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jtcmake.</span></span><span class="sig-name descname"><span class="pre">GroupsGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglevel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'debug'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'info'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'warning'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'error'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_default_logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jtcmake.GroupsGroup" title="Permalink to this definition"></a></dt>
<dd><p>A group that contains groups as children.</p>
<p>When writing type hints, children’s type can be passed as a generic
type parameter like <code class="docutils literal notranslate"><span class="pre">GroupsGroup[SomeGroupClass]</span></code> .</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>
<span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">SELF</span><span class="p">,</span> <span class="n">StaticGroupBase</span><span class="p">,</span> <span class="n">GroupsGroup</span><span class="p">,</span> <span class="n">Rule</span>

<span class="k">class</span> <span class="nc">Child1</span><span class="p">(</span><span class="n">StaticGroupBase</span><span class="p">):</span>
    <span class="vm">__globals__</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span>  <span class="c1"># For Sphinx&#39;s doctest. Not necessary in normal situations.</span>
    <span class="n">rule1</span><span class="p">:</span> <span class="n">Rule</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule1</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;&lt;R&gt;.txt&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">write_text</span><span class="p">)(</span><span class="n">SELF</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

<span class="k">class</span> <span class="nc">Child2</span><span class="p">(</span><span class="n">StaticGroupBase</span><span class="p">):</span>
    <span class="vm">__globals__</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span>  <span class="c1"># For Sphinx&#39;s doctest. Not necessary in normal situations.</span>
    <span class="n">rule2</span><span class="p">:</span> <span class="n">Rule</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule2</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;&lt;R&gt;.txt&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">write_text</span><span class="p">)(</span><span class="n">SELF</span><span class="p">,</span> <span class="n">text</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">g</span><span class="p">:</span> <span class="n">GroupsGroup</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Child1</span><span class="p">,</span> <span class="n">Child2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">GroupsGroup</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>

<span class="c1"># Set the child class to use by default</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_default_child</span><span class="p">(</span><span class="n">Child1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="c1"># Child1 will be the child class</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;child1-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="c1"># Explicity giving the child class Child2</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;child2-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">Child2</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="n">g</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/child1-0/rule1.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/child1-1/rule1.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/child2-0/rule2.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;00&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/child2-1/rule2.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;11&quot;</span>

<span class="kn">import</span> <span class="nn">shutil</span><span class="p">;</span> <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>  <span class="c1"># Cleanup for Sphinx&#39;s doctest</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglevel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'debug'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'info'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'warning'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'error'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_default_logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jtcmake.GroupsGroup.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>driname</strong> – directory name of this group.
<code class="docutils literal notranslate"><span class="pre">dirname=&quot;foo&quot;</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">prefix=&quot;foo/&quot;</span></code></p></li>
<li><p><strong>prefix</strong> – path prefix of this group.
You may not specify <code class="docutils literal notranslate"><span class="pre">dirname</span></code> and <code class="docutils literal notranslate"><span class="pre">prefix</span></code> at the same time.
If both <code class="docutils literal notranslate"><span class="pre">dirname</span></code> and <code class="docutils literal notranslate"><span class="pre">prefix</span></code> is none, prefix will be “”</p></li>
<li><p><strong>use_default_logger</strong> – if True, logs will be printed to stderr or
displayed as HTML if the code is running on Jupyter Notebook.</p></li>
<li><p><strong>logfile</strong> – str, PathLike, Logger, object with a <code class="docutils literal notranslate"><span class="pre">write(str)</span></code> method,
or list/tuple of them, indicating the target(s) to which logs
should be output.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.add_group">
<span class="sig-name descname"><span class="pre">add_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_group_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">T_Child</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">T_Child</span></span></span><a class="headerlink" href="#jtcmake.GroupsGroup.add_group" title="Permalink to this definition"></a></dt>
<dd><p>Append a child group to this group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name of the new child group.</p></li>
<li><p><strong>child_group_type</strong> – class of the new child group. If not specified, and if the
default child group class is available (set by
<code class="docutils literal notranslate"><span class="pre">self.set_default_child</span></code>), it will be used. Otherwise,
an exception will be raised.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#jtcmake.GroupsGroup.clean" title="Permalink to this definition"></a></dt>
<dd><p>Delete all the existing files of this group.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.groups">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">groups</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">T_Child</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jtcmake.GroupsGroup.groups" title="Permalink to this definition"></a></dt>
<dd><p>Readonly dictionary of child groups.</p>
<ul class="simple">
<li><p>Key: base name of the child group</p></li>
<li><p>Value: child group node object</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.make">
<span class="sig-name descname"><span class="pre">make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dry_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_going</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">njobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MakeSummary</span></span></span><a class="headerlink" href="#jtcmake.GroupsGroup.make" title="Permalink to this definition"></a></dt>
<dd><p>Make rules in this group and their dependencies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dry_run</strong> (<em>bool</em>) – instead of actually excuting the methods,
print expected execution logs.</p></li>
<li><p><strong>keep_going</strong> (<em>bool</em>) – If False (default), stop everything when a rule fails.
If True, when a rule fails, keep executing other rules
except the ones depend on the failed rule.</p></li>
<li><p><strong>njobs</strong> (<em>int</em>) – Maximum number of rules that can be made simultaneously using
multiple threads and processes.
Defaults to 1 (single process, single thread).</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See the description of jtcmake.make for more detail of njobs</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.prefix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prefix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#jtcmake.GroupsGroup.prefix" title="Permalink to this definition"></a></dt>
<dd><p>Path prefix of this group.</p>
<dl class="simple">
<dt>Seealso:</dt><dd><p><a class="reference internal" href="#jtcmake.GroupsGroup.set_prefix" title="jtcmake.GroupsGroup.set_prefix"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_prefix()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.rules">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rules</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jtcmake.Rule" title="jtcmake.group_tree.rule.Rule"><span class="pre">Rule</span></a><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jtcmake.GroupsGroup.rules" title="Permalink to this definition"></a></dt>
<dd><p>Readonly dictionary of child rules.</p>
<ul class="simple">
<li><p>Key: base name of the child rule</p></li>
<li><p>Value: child rule node object</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.select_files">
<span class="sig-name descname"><span class="pre">select_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jtcmake.IFile" title="jtcmake.group_tree.core.IFile"><span class="pre">IFile</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.GroupsGroup.select_files" title="Permalink to this definition"></a></dt>
<dd><p>Create list of files in this group sub-tree that match <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.</p>
<p>This is the file-version of <a class="reference internal" href="#jtcmake.GroupsGroup.select_groups" title="jtcmake.GroupsGroup.select_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">select_groups()</span></code></a>.
See its documentation for detail.</p>
<p class="rubric">Examples</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;ROOT&gt;
|-- a(r)
|   |-- a (f:a.txt)
|   `-- b (f:b.html)
|
`-- b(g)
    `-- a(r)
        `-- a (f:a.txt)
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span><span class="p">,</span> <span class="n">SELF</span>

<span class="c1"># Building the above group tree</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">()</span>  <span class="c1"># Root group</span>
<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;a.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="s2">&quot;b.html&quot;</span> <span class="p">},</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">SELF</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;a.txt&quot;</span> <span class="p">},</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_files</span><span class="p">(</span><span class="s2">&quot;**/a&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">a</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_files</span><span class="p">(</span><span class="s2">&quot;a/*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">b</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.select_groups">
<span class="sig-name descname"><span class="pre">select_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">IGroup</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.GroupsGroup.select_groups" title="Permalink to this definition"></a></dt>
<dd><p>Create list of groups in this group sub-tree that match <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.
The list may include this group itself.</p>
<p>Groups are gathered based on the given pattern in a manner similar to
how we specify a set of files using a glob pattern on Unix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pattern</strong> – <p>str or list/tuple of str representing a pattern of
relative names of offspring nodes.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">pattern</span></code> is a list/tuple of strs,
it must be a sequence of <em>base name patterns</em> like
<code class="docutils literal notranslate"><span class="pre">[&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;]</span></code> or <code class="docutils literal notranslate"><span class="pre">[&quot;a&quot;,</span> <span class="pre">&quot;*b*&quot;,</span> <span class="pre">&quot;c&quot;,</span> <span class="pre">&quot;**&quot;]</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">pattern</span></code> is a str, it will be internally translated into
an equivalent list-of-str pattern by splitting it with <code class="docutils literal notranslate"><span class="pre">/</span></code>.
So, for example, <code class="docutils literal notranslate"><span class="pre">g.select_groups(&quot;a/b/c&quot;)</span> <span class="pre">is</span> <span class="pre">equivalent</span> <span class="pre">to</span>
<span class="pre">``g.select_groups([&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;])</span></code>.</p>
</p>
</dd>
</dl>
<p>Suppose we have the following group tree (the tree may have rules as
well but we omit them since this method collects groups only).</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;ROOT&gt;
|
|-- a1
|   |-- b1
|   `-- b2
|       `-- c1
|
|-- a2
|   `-- b1
|
`-- a1/b1
</pre></div>
</div>
<p>We use a list of strs to identify each group node.
For example, the (absolute) name of the forth group from the top
(the deepest one) is <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;,</span> <span class="pre">&quot;b2&quot;,</span> <span class="pre">&quot;c1&quot;]</span></code>.
Its <em>relative name</em> with respect to the group <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;]</span></code> is
<code class="docutils literal notranslate"><span class="pre">[&quot;b2&quot;,</span> <span class="pre">&quot;c1&quot;]</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;c1&quot;</span></code> is its <em>base name</em>.</p>
<p>Pattern matching is basically as simple as <em>pattern</em> <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;,</span> <span class="pre">&quot;b1&quot;]</span></code>
matches the <em>relative name</em> <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;,</span> <span class="pre">&quot;b1&quot;]</span></code>.
Additionally, you can use wildcard <code class="docutils literal notranslate"><span class="pre">*</span></code> in patterns as follows.</p>
<ul class="simple">
<li><p>Double stars <code class="docutils literal notranslate"><span class="pre">**</span></code> can appear as a special base name indicating
zero or more repetition of arbitrary base names.
It may NOT appear inside a base name like <code class="docutils literal notranslate"><span class="pre">a/**b/c</span></code></p></li>
<li><p>Single stars <code class="docutils literal notranslate"><span class="pre">*</span></code> can appear inside a base name indicating zero
or more repetition of arbitrary character.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span>

<span class="c1"># Building the above group tree</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">()</span>  <span class="c1"># Root group</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b2&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;c1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a2&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">([</span><span class="s2">&quot;a1&quot;</span><span class="p">,</span> <span class="s2">&quot;b1&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">]</span>

<span class="c1"># In the following example,  ``/`` in the base name is treated</span>
<span class="c1"># as a normal character and has no effect as a base name boundary</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">([</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">]]</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;a*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">]]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;*/*1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">b1</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;**/*1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">c1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">]</span>
<span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;**&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span>
    <span class="n">g</span><span class="p">,</span>  <span class="c1"># root is included</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">c1</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span>
    <span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">],</span>
<span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;a1/*&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Current implementation collects nodes using pre-order DFS but
it may be changed in the future.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.select_rules">
<span class="sig-name descname"><span class="pre">select_rules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">IRule</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.GroupsGroup.select_rules" title="Permalink to this definition"></a></dt>
<dd><p>Create list of rules in this group sub-tree that match <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.</p>
<p>This is the rule-version of <a class="reference internal" href="#jtcmake.GroupsGroup.select_groups" title="jtcmake.GroupsGroup.select_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">select_groups()</span></code></a>.
See its documentation for detail.</p>
<p class="rubric">Examples</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;ROOT&gt;
|-- a0(r)
|-- a1
|   `-- a2(r)
`-- a3
    `-- a4(r)
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span><span class="p">,</span> <span class="n">SELF</span>

<span class="c1"># Building the above group tree</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">()</span>  <span class="c1"># Root group</span>
<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a0&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a2&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a3&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a4&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_rules</span><span class="p">(</span><span class="s2">&quot;a*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a0</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_rules</span><span class="p">(</span><span class="s2">&quot;*/a*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">a4</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.set_default_child">
<span class="sig-name descname"><span class="pre">set_default_child</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_child_group_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">T_Child</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jtcmake.GroupsGroup" title="jtcmake.group_tree.groups.GroupsGroup"><span class="pre">GroupsGroup</span></a><span class="p"><span class="pre">[</span></span><span class="pre">T_Child</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.GroupsGroup.set_default_child" title="Permalink to this definition"></a></dt>
<dd><p>Sets the default child class, which will be used when
<a class="reference internal" href="#jtcmake.GroupsGroup.add_group" title="jtcmake.GroupsGroup.add_group"><code class="xref py py-func docutils literal notranslate"><span class="pre">GroupsGroup.add_group()</span></code></a> is called with <code class="docutils literal notranslate"><span class="pre">child_group_type</span></code>
unspecified.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.set_prefix">
<span class="sig-name descname"><span class="pre">set_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">T_Self</span></span></span><a class="headerlink" href="#jtcmake.GroupsGroup.set_prefix" title="Permalink to this definition"></a></dt>
<dd><p>Set the path prefix of this group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dirname</strong> – if specified, prefix will be <code class="docutils literal notranslate"><span class="pre">dirname</span> <span class="pre">+</span> <span class="pre">&quot;/&quot;</span></code></p></li>
<li><p><strong>prefix</strong> – path prefix.</p></li>
</ul>
</dd>
</dl>
<p>You must specify either but not both of <code class="docutils literal notranslate"><span class="pre">dirname</span></code> or <code class="docutils literal notranslate"><span class="pre">prefix</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">self.set_prefix(&quot;a&quot;)</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">self.set_prefix(prefix=&quot;a/&quot;)</span></code>.</p>
<p>If this group is not the root group and the given prefix is a
relative path, the path prefix of the parent group will be added to
its start. Absolute paths do not undergo this prefixing.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method may be called only when the prefix is not yet
determined. i.e. You may NOT call this method whenever,</p>
<ul class="simple">
<li><p>You have created this group as a root group</p></li>
<li><p>You have once called it</p></li>
<li><p>You have once read <a class="reference internal" href="#jtcmake.GroupsGroup.prefix" title="jtcmake.GroupsGroup.prefix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">self.prefix</span></code></a>:
reading <a class="reference internal" href="#jtcmake.GroupsGroup.prefix" title="jtcmake.GroupsGroup.prefix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">self.prefix</span></code></a> internally finalizes
the prefix to <code class="docutils literal notranslate"><span class="pre">&quot;{name</span> <span class="pre">of</span> <span class="pre">this</span> <span class="pre">group}/&quot;</span></code></p></li>
<li><p>You have once read the prefix of a child group:
reading a child’s prefix internally reads the parent’s prefix</p></li>
<li><p>You have initialized any rule in the sub-tree:
initializing a rule internally reads its parent’s prefix</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># (For Unix only)</span>

<span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">(</span><span class="s2">&quot;root&quot;</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_prefix</span><span class="p">(</span><span class="s2">&quot;foo-dir&quot;</span><span class="p">)</span>  <span class="c1"># dirname</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;bar-&quot;</span><span class="p">)</span>  <span class="c1"># prefix</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;baz&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_prefix</span><span class="p">(</span><span class="s2">&quot;/tmp/baz&quot;</span><span class="p">)</span>  <span class="c1"># dirname abspath</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;qux&quot;</span><span class="p">)</span>  <span class="c1"># no explicit setting</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/foo-dir/&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/bar-&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">baz</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;/tmp/baz/&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">qux</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/qux/&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.set_props">
<span class="sig-name descname"><span class="pre">set_props</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_child_group_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">T_Child</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">StrOrPath</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">StrOrPath</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jtcmake.GroupsGroup" title="jtcmake.GroupsGroup"><span class="pre">GroupsGroup</span></a><span class="p"><span class="pre">[</span></span><span class="pre">T_Child</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.GroupsGroup.set_props" title="Permalink to this definition"></a></dt>
<dd><p>Convenient method that works as <a class="reference internal" href="#jtcmake.GroupsGroup.set_default_child" title="jtcmake.GroupsGroup.set_default_child"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_default_child()</span></code></a>
and <cite>set_prefix</cite> combined.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.GroupsGroup.touch">
<span class="sig-name descname"><span class="pre">touch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#jtcmake.GroupsGroup.touch" title="Permalink to this definition"></a></dt>
<dd><p>For every rule in the group, touch (set mtime to now) the output files
and force the memo to record the current input state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>bool</em>) – if False, files won’t be touched. Defaults to True.</p></li>
<li><p><strong>memo</strong> (<em>bool</em>) – if False, memos won’t be modified. Defaults to True.</p></li>
<li><p><strong>create</strong> (<em>bool</em>) – if True, missing files will be created. Otherwise,
only the existing files will be touched.
This option has no effect with <code class="docutils literal notranslate"><span class="pre">file=False</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jtcmake.RulesGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jtcmake.</span></span><span class="sig-name descname"><span class="pre">RulesGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglevel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'debug'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'info'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'warning'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'error'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_default_logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jtcmake.RulesGroup" title="Permalink to this definition"></a></dt>
<dd><p>A group that contains rules as children.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">RulesGroup</span><span class="p">,</span> <span class="n">SELF</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">RulesGroup</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;child</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">write_text</span><span class="p">)(</span><span class="n">SELF</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="n">g</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/child0.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/child1.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/child2.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;2&quot;</span>

<span class="kn">import</span> <span class="nn">shutil</span><span class="p">;</span> <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>  <span class="c1"># Cleanup for Sphinx&#39;s doctest</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglevel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'debug'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'info'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'warning'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'error'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_default_logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jtcmake.RulesGroup.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>driname</strong> – directory name of this group.
<code class="docutils literal notranslate"><span class="pre">dirname=&quot;foo&quot;</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">prefix=&quot;foo/&quot;</span></code></p></li>
<li><p><strong>prefix</strong> – path prefix of this group.
You may not specify <code class="docutils literal notranslate"><span class="pre">dirname</span></code> and <code class="docutils literal notranslate"><span class="pre">prefix</span></code> at the same time.
If both <code class="docutils literal notranslate"><span class="pre">dirname</span></code> and <code class="docutils literal notranslate"><span class="pre">prefix</span></code> is none, prefix will be “”</p></li>
<li><p><strong>use_default_logger</strong> – if True, logs will be printed to stderr or
displayed as HTML if the code is running on Jupyter Notebook.</p></li>
<li><p><strong>logfile</strong> – str, PathLike, Logger, object with a <code class="docutils literal notranslate"><span class="pre">write(str)</span></code> method,
or list/tuple of them, indicating the target(s) to which logs
should be output.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jtcmake.Rule" title="jtcmake.group_tree.rule.Rule"><span class="pre">Rule</span></a><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.RulesGroup.add" title="Permalink to this definition"></a></dt>
<dd><p>Create a temporary function to add a rule to this group.</p>
<p>This method works similarly to <a class="reference internal" href="#jtcmake.Rule.init" title="jtcmake.Rule.init"><code class="xref py py-func docutils literal notranslate"><span class="pre">Rule.init()</span></code></a>.
See its documentation for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the rule.</p></li>
<li><p><strong>output_files</strong> – if not specified, <code class="docutils literal notranslate"><span class="pre">name</span></code> will be used.</p></li>
<li><p><strong>method</strong> – function to create the output files</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>rule_adder</em>, a temporary function whose signature is the same as
the given <code class="docutils literal notranslate"><span class="pre">method</span></code>.
Calling it as <code class="docutils literal notranslate"><span class="pre">rule_adder(*args,</span> <span class="pre">**kwargs)</span></code> appends
a new rule to the group.</p>
<p>While executing this rule, <code class="docutils literal notranslate"><span class="pre">method</span></code> is called as
<code class="docutils literal notranslate"><span class="pre">method(*args,</span> <span class="pre">**kwargs)</span></code>.</p>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">RulesGroup</span><span class="p">,</span> <span class="n">SELF</span><span class="p">,</span> <span class="n">VFile</span><span class="p">,</span> <span class="n">File</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">RulesGroup</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">split_write</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file1</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">file2</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
    <span class="c1"># Write first half of ``text`` to file1 and the rest to file2</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">file1</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span><span class="p">[:</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">file2</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span> <span class="n">n</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">cat</span><span class="p">(</span><span class="n">srcs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">dst</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">dst</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">srcs</span><span class="p">)</span>

<span class="c1"># File path may be str or PathLike</span>
<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;a.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;b.txt&quot;</span><span class="p">)},</span> <span class="n">split_write</span><span class="p">)(</span><span class="s2">&quot;abcd&quot;</span><span class="p">,</span> <span class="n">SELF</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SELF</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;x.txt&quot;</span><span class="p">,</span> <span class="n">VFile</span><span class="p">(</span><span class="s2">&quot;y.txt&quot;</span><span class="p">)],</span> <span class="n">split_write</span><span class="p">)(</span><span class="s2">&quot;efgh&quot;</span><span class="p">,</span> <span class="n">SELF</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SELF</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;baz&quot;</span><span class="p">,</span> <span class="s2">&quot;baz.txt&quot;</span><span class="p">,</span> <span class="n">cat</span><span class="p">)([</span><span class="n">g</span><span class="o">.</span><span class="n">foo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">foo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">bar</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">bar</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">SELF</span><span class="p">)</span>

<span class="c1"># file paths of str or PathLike (excluding File/VFile) are</span>
<span class="c1"># internally converted to File</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">bar</span><span class="p">[</span><span class="s2">&quot;x.txt&quot;</span><span class="p">],</span> <span class="n">File</span><span class="p">)</span>

<span class="c1"># file paths of VFile remains VFile</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">bar</span><span class="p">[</span><span class="s2">&quot;y.txt&quot;</span><span class="p">],</span> <span class="n">VFile</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/a.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;ab&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/b.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;cd&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/x.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;ef&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/y.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;gh&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/baz.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abcdefgh&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.add_deco">
<span class="sig-name descname"><span class="pre">add_deco</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_files</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_T_deco_f</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_T_deco_f</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.RulesGroup.add_deco" title="Permalink to this definition"></a></dt>
<dd><p>Create a temporary decorator function to add a rule to this group.
This is a decorator version of <a class="reference internal" href="#jtcmake.RulesGroup.add" title="jtcmake.RulesGroup.add"><code class="xref py py-func docutils literal notranslate"><span class="pre">add()</span></code></a>.
It’s useful when you want to define a method for the new rule
on-the-fly instead of passing an existing function
(see the examples below).</p>
<p>This method workds similarly to <a class="reference internal" href="#jtcmake.Rule.init_deco" title="jtcmake.Rule.init_deco"><code class="xref py py-func docutils literal notranslate"><span class="pre">Rule.init_deco()</span></code></a>.
See its documentation for detail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the rule to be added</p></li>
<li><p><strong>output_files</strong> – output files of the rule.
See <a class="reference internal" href="#jtcmake.RulesGroup.add" title="jtcmake.RulesGroup.add"><code class="xref py py-func docutils literal notranslate"><span class="pre">add()</span></code></a> for more information.
Just like <a class="reference internal" href="#jtcmake.RulesGroup.add" title="jtcmake.RulesGroup.add"><code class="xref py py-func docutils literal notranslate"><span class="pre">add()</span></code></a>, file paths will be internally
converted to <a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">jtcmake.File</span></code></a> if they aren’t either
<a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">jtcmake.File</span></code></a> or <a class="reference internal" href="#jtcmake.VFile" title="jtcmake.VFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">jtcmake.VFile</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rule_method_decorator</strong>.</p>
</dd>
</dl>
<dl>
<dt>Usage:</dt><dd><p>Invoking the <code class="docutils literal notranslate"><span class="pre">rule_method_decorator</span></code> with the method you want to
bind to the new rule creates the rule and append it to this group.</p>
<p>All the arguments to the method must have a default value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">add_deco</span><span class="p">(</span><span class="s2">&quot;myrule1&quot;</span><span class="p">)(</span><span class="k">lambda</span> <span class="n">p</span><span class="o">=</span><span class="n">SELF</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">))</span>

<span class="nd">@g</span><span class="o">.</span><span class="n">add_deco</span><span class="p">(</span><span class="s2">&quot;myrule2&quot;</span><span class="p">,</span> <span class="s2">&quot;out.txt&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">method_for_myrule2</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">myrule1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dst</span><span class="o">=</span><span class="n">SELF</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">myrule2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abcabc&quot;</span>
</pre></div>
</div>
<p>The above is equivalent to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;myrule1&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">p</span><span class="o">=</span><span class="n">SELF</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">))(</span><span class="n">SELF</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">method_for_myrule2</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">myrule1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dst</span><span class="o">=</span><span class="n">SELF</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;myrule2&quot;</span><span class="p">,</span> <span class="s2">&quot;out.txt&quot;</span><span class="p">,</span> <span class="n">method_for_myrule2</span><span class="p">)(</span>
    <span class="n">g</span><span class="o">.</span><span class="n">myrule1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SELF</span><span class="p">,</span> <span class="mi">2</span>
<span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.addvf">
<span class="sig-name descname"><span class="pre">addvf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jtcmake.Rule" title="jtcmake.group_tree.rule.Rule"><span class="pre">Rule</span></a><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.RulesGroup.addvf" title="Permalink to this definition"></a></dt>
<dd><p>Create a temporary function to add a rule to this group.</p>
<p>This method is equal to <code class="xref py py-func docutils literal notranslate"><span class="pre">self.add</span></code> except the default
file class is <a class="reference internal" href="#jtcmake.VFile" title="jtcmake.VFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">VFile</span></code></a> instead of <a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a>.</p>
<p>See the documentation of <code class="xref py py-func docutils literal notranslate"><span class="pre">self.add</span></code> for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.addvf_deco">
<span class="sig-name descname"><span class="pre">addvf_deco</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_files</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_T_deco_f</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_T_deco_f</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.RulesGroup.addvf_deco" title="Permalink to this definition"></a></dt>
<dd><p>Create a temporary decorator function to add a rule to this group.</p>
<p>This method is equal to <a class="reference internal" href="#jtcmake.RulesGroup.add_deco" title="jtcmake.RulesGroup.add_deco"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_deco()</span></code></a> except the default file
constructor is <a class="reference internal" href="#jtcmake.VFile" title="jtcmake.VFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">jtcmake.VFile</span></code></a> instead of <a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a>.</p>
<p>See <a class="reference internal" href="#jtcmake.RulesGroup.add_deco" title="jtcmake.RulesGroup.add_deco"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_deco()</span></code></a> and <a class="reference internal" href="#jtcmake.RulesGroup.add" title="jtcmake.RulesGroup.add"><code class="xref py py-func docutils literal notranslate"><span class="pre">add()</span></code></a> for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#jtcmake.RulesGroup.clean" title="Permalink to this definition"></a></dt>
<dd><p>Delete all the existing files of this group.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.groups">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">groups</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">IGroup</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jtcmake.RulesGroup.groups" title="Permalink to this definition"></a></dt>
<dd><p>Readonly dictionary of child groups.</p>
<ul class="simple">
<li><p>Key: base name of the child group</p></li>
<li><p>Value: child group node object</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.make">
<span class="sig-name descname"><span class="pre">make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dry_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_going</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">njobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MakeSummary</span></span></span><a class="headerlink" href="#jtcmake.RulesGroup.make" title="Permalink to this definition"></a></dt>
<dd><p>Make rules in this group and their dependencies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dry_run</strong> (<em>bool</em>) – instead of actually excuting the methods,
print expected execution logs.</p></li>
<li><p><strong>keep_going</strong> (<em>bool</em>) – If False (default), stop everything when a rule fails.
If True, when a rule fails, keep executing other rules
except the ones depend on the failed rule.</p></li>
<li><p><strong>njobs</strong> (<em>int</em>) – Maximum number of rules that can be made simultaneously using
multiple threads and processes.
Defaults to 1 (single process, single thread).</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See the description of jtcmake.make for more detail of njobs</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.prefix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prefix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#jtcmake.RulesGroup.prefix" title="Permalink to this definition"></a></dt>
<dd><p>Path prefix of this group.</p>
<dl class="simple">
<dt>Seealso:</dt><dd><p><a class="reference internal" href="#jtcmake.RulesGroup.set_prefix" title="jtcmake.RulesGroup.set_prefix"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_prefix()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.rules">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rules</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jtcmake.Rule" title="jtcmake.group_tree.rule.Rule"><span class="pre">Rule</span></a><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jtcmake.RulesGroup.rules" title="Permalink to this definition"></a></dt>
<dd><p>Readonly dictionary of child rules.</p>
<ul class="simple">
<li><p>Key: base name of the child rule</p></li>
<li><p>Value: child rule node object</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.select_files">
<span class="sig-name descname"><span class="pre">select_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jtcmake.IFile" title="jtcmake.group_tree.core.IFile"><span class="pre">IFile</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.RulesGroup.select_files" title="Permalink to this definition"></a></dt>
<dd><p>Create list of files in this group sub-tree that match <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.</p>
<p>This is the file-version of <a class="reference internal" href="#jtcmake.RulesGroup.select_groups" title="jtcmake.RulesGroup.select_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">select_groups()</span></code></a>.
See its documentation for detail.</p>
<p class="rubric">Examples</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;ROOT&gt;
|-- a(r)
|   |-- a (f:a.txt)
|   `-- b (f:b.html)
|
`-- b(g)
    `-- a(r)
        `-- a (f:a.txt)
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span><span class="p">,</span> <span class="n">SELF</span>

<span class="c1"># Building the above group tree</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">()</span>  <span class="c1"># Root group</span>
<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;a.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="s2">&quot;b.html&quot;</span> <span class="p">},</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">SELF</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;a.txt&quot;</span> <span class="p">},</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_files</span><span class="p">(</span><span class="s2">&quot;**/a&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">a</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_files</span><span class="p">(</span><span class="s2">&quot;a/*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">b</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.select_groups">
<span class="sig-name descname"><span class="pre">select_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">IGroup</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.RulesGroup.select_groups" title="Permalink to this definition"></a></dt>
<dd><p>Create list of groups in this group sub-tree that match <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.
The list may include this group itself.</p>
<p>Groups are gathered based on the given pattern in a manner similar to
how we specify a set of files using a glob pattern on Unix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pattern</strong> – <p>str or list/tuple of str representing a pattern of
relative names of offspring nodes.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">pattern</span></code> is a list/tuple of strs,
it must be a sequence of <em>base name patterns</em> like
<code class="docutils literal notranslate"><span class="pre">[&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;]</span></code> or <code class="docutils literal notranslate"><span class="pre">[&quot;a&quot;,</span> <span class="pre">&quot;*b*&quot;,</span> <span class="pre">&quot;c&quot;,</span> <span class="pre">&quot;**&quot;]</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">pattern</span></code> is a str, it will be internally translated into
an equivalent list-of-str pattern by splitting it with <code class="docutils literal notranslate"><span class="pre">/</span></code>.
So, for example, <code class="docutils literal notranslate"><span class="pre">g.select_groups(&quot;a/b/c&quot;)</span> <span class="pre">is</span> <span class="pre">equivalent</span> <span class="pre">to</span>
<span class="pre">``g.select_groups([&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;])</span></code>.</p>
</p>
</dd>
</dl>
<p>Suppose we have the following group tree (the tree may have rules as
well but we omit them since this method collects groups only).</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;ROOT&gt;
|
|-- a1
|   |-- b1
|   `-- b2
|       `-- c1
|
|-- a2
|   `-- b1
|
`-- a1/b1
</pre></div>
</div>
<p>We use a list of strs to identify each group node.
For example, the (absolute) name of the forth group from the top
(the deepest one) is <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;,</span> <span class="pre">&quot;b2&quot;,</span> <span class="pre">&quot;c1&quot;]</span></code>.
Its <em>relative name</em> with respect to the group <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;]</span></code> is
<code class="docutils literal notranslate"><span class="pre">[&quot;b2&quot;,</span> <span class="pre">&quot;c1&quot;]</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;c1&quot;</span></code> is its <em>base name</em>.</p>
<p>Pattern matching is basically as simple as <em>pattern</em> <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;,</span> <span class="pre">&quot;b1&quot;]</span></code>
matches the <em>relative name</em> <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;,</span> <span class="pre">&quot;b1&quot;]</span></code>.
Additionally, you can use wildcard <code class="docutils literal notranslate"><span class="pre">*</span></code> in patterns as follows.</p>
<ul class="simple">
<li><p>Double stars <code class="docutils literal notranslate"><span class="pre">**</span></code> can appear as a special base name indicating
zero or more repetition of arbitrary base names.
It may NOT appear inside a base name like <code class="docutils literal notranslate"><span class="pre">a/**b/c</span></code></p></li>
<li><p>Single stars <code class="docutils literal notranslate"><span class="pre">*</span></code> can appear inside a base name indicating zero
or more repetition of arbitrary character.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span>

<span class="c1"># Building the above group tree</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">()</span>  <span class="c1"># Root group</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b2&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;c1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a2&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">([</span><span class="s2">&quot;a1&quot;</span><span class="p">,</span> <span class="s2">&quot;b1&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">]</span>

<span class="c1"># In the following example,  ``/`` in the base name is treated</span>
<span class="c1"># as a normal character and has no effect as a base name boundary</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">([</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">]]</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;a*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">]]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;*/*1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">b1</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;**/*1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">c1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">]</span>
<span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;**&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span>
    <span class="n">g</span><span class="p">,</span>  <span class="c1"># root is included</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">c1</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span>
    <span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">],</span>
<span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;a1/*&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Current implementation collects nodes using pre-order DFS but
it may be changed in the future.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.select_rules">
<span class="sig-name descname"><span class="pre">select_rules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">IRule</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.RulesGroup.select_rules" title="Permalink to this definition"></a></dt>
<dd><p>Create list of rules in this group sub-tree that match <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.</p>
<p>This is the rule-version of <a class="reference internal" href="#jtcmake.RulesGroup.select_groups" title="jtcmake.RulesGroup.select_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">select_groups()</span></code></a>.
See its documentation for detail.</p>
<p class="rubric">Examples</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;ROOT&gt;
|-- a0(r)
|-- a1
|   `-- a2(r)
`-- a3
    `-- a4(r)
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span><span class="p">,</span> <span class="n">SELF</span>

<span class="c1"># Building the above group tree</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">()</span>  <span class="c1"># Root group</span>
<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a0&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a2&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a3&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a4&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_rules</span><span class="p">(</span><span class="s2">&quot;a*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a0</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_rules</span><span class="p">(</span><span class="s2">&quot;*/a*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">a4</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.set_prefix">
<span class="sig-name descname"><span class="pre">set_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">T_Self</span></span></span><a class="headerlink" href="#jtcmake.RulesGroup.set_prefix" title="Permalink to this definition"></a></dt>
<dd><p>Set the path prefix of this group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dirname</strong> – if specified, prefix will be <code class="docutils literal notranslate"><span class="pre">dirname</span> <span class="pre">+</span> <span class="pre">&quot;/&quot;</span></code></p></li>
<li><p><strong>prefix</strong> – path prefix.</p></li>
</ul>
</dd>
</dl>
<p>You must specify either but not both of <code class="docutils literal notranslate"><span class="pre">dirname</span></code> or <code class="docutils literal notranslate"><span class="pre">prefix</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">self.set_prefix(&quot;a&quot;)</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">self.set_prefix(prefix=&quot;a/&quot;)</span></code>.</p>
<p>If this group is not the root group and the given prefix is a
relative path, the path prefix of the parent group will be added to
its start. Absolute paths do not undergo this prefixing.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method may be called only when the prefix is not yet
determined. i.e. You may NOT call this method whenever,</p>
<ul class="simple">
<li><p>You have created this group as a root group</p></li>
<li><p>You have once called it</p></li>
<li><p>You have once read <a class="reference internal" href="#jtcmake.RulesGroup.prefix" title="jtcmake.RulesGroup.prefix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">self.prefix</span></code></a>:
reading <a class="reference internal" href="#jtcmake.RulesGroup.prefix" title="jtcmake.RulesGroup.prefix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">self.prefix</span></code></a> internally finalizes
the prefix to <code class="docutils literal notranslate"><span class="pre">&quot;{name</span> <span class="pre">of</span> <span class="pre">this</span> <span class="pre">group}/&quot;</span></code></p></li>
<li><p>You have once read the prefix of a child group:
reading a child’s prefix internally reads the parent’s prefix</p></li>
<li><p>You have initialized any rule in the sub-tree:
initializing a rule internally reads its parent’s prefix</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># (For Unix only)</span>

<span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">(</span><span class="s2">&quot;root&quot;</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_prefix</span><span class="p">(</span><span class="s2">&quot;foo-dir&quot;</span><span class="p">)</span>  <span class="c1"># dirname</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;bar-&quot;</span><span class="p">)</span>  <span class="c1"># prefix</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;baz&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_prefix</span><span class="p">(</span><span class="s2">&quot;/tmp/baz&quot;</span><span class="p">)</span>  <span class="c1"># dirname abspath</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;qux&quot;</span><span class="p">)</span>  <span class="c1"># no explicit setting</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/foo-dir/&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/bar-&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">baz</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;/tmp/baz/&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">qux</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/qux/&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.RulesGroup.touch">
<span class="sig-name descname"><span class="pre">touch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#jtcmake.RulesGroup.touch" title="Permalink to this definition"></a></dt>
<dd><p>For every rule in the group, touch (set mtime to now) the output files
and force the memo to record the current input state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>bool</em>) – if False, files won’t be touched. Defaults to True.</p></li>
<li><p><strong>memo</strong> (<em>bool</em>) – if False, memos won’t be modified. Defaults to True.</p></li>
<li><p><strong>create</strong> (<em>bool</em>) – if True, missing files will be created. Otherwise,
only the existing files will be touched.
This option has no effect with <code class="docutils literal notranslate"><span class="pre">file=False</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jtcmake.</span></span><span class="sig-name descname"><span class="pre">UntypedGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglevel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'debug'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'info'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'warning'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'error'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_default_logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jtcmake.UntypedGroup" title="Permalink to this definition"></a></dt>
<dd><p>A group that have groups and rules as children.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Type annotation for this class is weak and you won’t get much support
from static type checkers and IDEs.
It is recommended to use <a class="reference internal" href="#jtcmake.StaticGroupBase" title="jtcmake.StaticGroupBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">StaticGroupBase</span></code></a>, <a class="reference internal" href="#jtcmake.GroupsGroup" title="jtcmake.GroupsGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">GroupsGroup</span></code></a>, and
<a class="reference internal" href="#jtcmake.RulesGroup" title="jtcmake.RulesGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">RulesGroup</span></code></a> when writing a long code.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span><span class="p">,</span> <span class="n">SELF</span><span class="p">,</span> <span class="n">Rule</span><span class="p">,</span> <span class="n">StaticGroupBase</span>

<span class="k">def</span> <span class="nf">add1</span><span class="p">(</span><span class="n">src</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">dst</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">read_text</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>

<span class="nd">@g</span><span class="o">.</span><span class="n">add_deco</span><span class="p">(</span><span class="s2">&quot;rule0&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_write_0</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">SELF</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;rule1&quot;</span><span class="p">,</span> <span class="n">add1</span><span class="p">)(</span><span class="n">g</span><span class="o">.</span><span class="n">rule0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SELF</span><span class="p">)</span>

<span class="c1"># ``add_group`` with ``child_group_type=None`` adds an UntypedGroup</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;group1&quot;</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">group1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;rule2&quot;</span><span class="p">,</span> <span class="n">add1</span><span class="p">)(</span><span class="n">g</span><span class="o">.</span><span class="n">rule1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SELF</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">StaticGroupBase</span><span class="p">):</span>
    <span class="vm">__globals__</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span>  <span class="c1"># For Sphinx&#39;s doctest. Not necessary in normal situations.</span>
    <span class="n">rule</span><span class="p">:</span> <span class="n">Rule</span>

<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;group2&quot;</span><span class="p">,</span> <span class="n">Child</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">group2</span><span class="o">.</span><span class="n">rule</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;rule3&quot;</span><span class="p">,</span> <span class="n">add1</span><span class="p">)(</span><span class="n">g</span><span class="o">.</span><span class="n">group1</span><span class="o">.</span><span class="n">rule2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SELF</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/rule0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/rule1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/group1/rule2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;2&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/group2/rule3&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;3&quot;</span>

<span class="kn">import</span> <span class="nn">shutil</span><span class="p">;</span> <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>  <span class="c1"># Cleanup for Sphinx&#39;s doctest</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglevel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'debug'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'info'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'warning'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'error'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_default_logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Logger</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">WritableProtocol</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jtcmake.UntypedGroup.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>driname</strong> – directory name of this group.
<code class="docutils literal notranslate"><span class="pre">dirname=&quot;foo&quot;</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">prefix=&quot;foo/&quot;</span></code></p></li>
<li><p><strong>prefix</strong> – path prefix of this group.
You may not specify <code class="docutils literal notranslate"><span class="pre">dirname</span></code> and <code class="docutils literal notranslate"><span class="pre">prefix</span></code> at the same time.
If both <code class="docutils literal notranslate"><span class="pre">dirname</span></code> and <code class="docutils literal notranslate"><span class="pre">prefix</span></code> is none, prefix will be “”</p></li>
<li><p><strong>use_default_logger</strong> – if True, logs will be printed to stderr or
displayed as HTML if the code is running on Jupyter Notebook.</p></li>
<li><p><strong>logfile</strong> – str, PathLike, Logger, object with a <code class="docutils literal notranslate"><span class="pre">write(str)</span></code> method,
or list/tuple of them, indicating the target(s) to which logs
should be output.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jtcmake.Rule" title="jtcmake.group_tree.rule.Rule"><span class="pre">Rule</span></a><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.UntypedGroup.add" title="Permalink to this definition"></a></dt>
<dd><p>Create a temporary function to add a rule to this group.</p>
<p>This method works similarly to <a class="reference internal" href="#jtcmake.Rule.init" title="jtcmake.Rule.init"><code class="xref py py-func docutils literal notranslate"><span class="pre">Rule.init()</span></code></a>.
See its documentation for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the rule.</p></li>
<li><p><strong>output_files</strong> – if not specified, <code class="docutils literal notranslate"><span class="pre">name</span></code> will be used.</p></li>
<li><p><strong>method</strong> – function to create the output files</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>rule_adder</em>, a temporary function whose signature is the same as
the given <code class="docutils literal notranslate"><span class="pre">method</span></code>.
Calling it as <code class="docutils literal notranslate"><span class="pre">rule_adder(*args,</span> <span class="pre">**kwargs)</span></code> appends
a new rule to the group.</p>
<p>While executing this rule, <code class="docutils literal notranslate"><span class="pre">method</span></code> is called as
<code class="docutils literal notranslate"><span class="pre">method(*args,</span> <span class="pre">**kwargs)</span></code>.</p>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">RulesGroup</span><span class="p">,</span> <span class="n">SELF</span><span class="p">,</span> <span class="n">VFile</span><span class="p">,</span> <span class="n">File</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">RulesGroup</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">split_write</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file1</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">file2</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
    <span class="c1"># Write first half of ``text`` to file1 and the rest to file2</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">file1</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span><span class="p">[:</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">file2</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span> <span class="n">n</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">cat</span><span class="p">(</span><span class="n">srcs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">dst</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">dst</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">srcs</span><span class="p">)</span>

<span class="c1"># File path may be str or PathLike</span>
<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;a.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;b.txt&quot;</span><span class="p">)},</span> <span class="n">split_write</span><span class="p">)(</span><span class="s2">&quot;abcd&quot;</span><span class="p">,</span> <span class="n">SELF</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SELF</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;x.txt&quot;</span><span class="p">,</span> <span class="n">VFile</span><span class="p">(</span><span class="s2">&quot;y.txt&quot;</span><span class="p">)],</span> <span class="n">split_write</span><span class="p">)(</span><span class="s2">&quot;efgh&quot;</span><span class="p">,</span> <span class="n">SELF</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SELF</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;baz&quot;</span><span class="p">,</span> <span class="s2">&quot;baz.txt&quot;</span><span class="p">,</span> <span class="n">cat</span><span class="p">)([</span><span class="n">g</span><span class="o">.</span><span class="n">foo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">foo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">bar</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">bar</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">SELF</span><span class="p">)</span>

<span class="c1"># file paths of str or PathLike (excluding File/VFile) are</span>
<span class="c1"># internally converted to File</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">bar</span><span class="p">[</span><span class="s2">&quot;x.txt&quot;</span><span class="p">],</span> <span class="n">File</span><span class="p">)</span>

<span class="c1"># file paths of VFile remains VFile</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">bar</span><span class="p">[</span><span class="s2">&quot;y.txt&quot;</span><span class="p">],</span> <span class="n">VFile</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/a.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;ab&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/b.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;cd&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/x.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;ef&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/y.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;gh&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/baz.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abcdefgh&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.add_deco">
<span class="sig-name descname"><span class="pre">add_deco</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_files</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_T_deco_f</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_T_deco_f</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.UntypedGroup.add_deco" title="Permalink to this definition"></a></dt>
<dd><p>Create a temporary decorator function to add a rule to this group.
This is a decorator version of <a class="reference internal" href="#jtcmake.UntypedGroup.add" title="jtcmake.UntypedGroup.add"><code class="xref py py-func docutils literal notranslate"><span class="pre">add()</span></code></a>.
It’s useful when you want to define a method for the new rule
on-the-fly instead of passing an existing function
(see the examples below).</p>
<p>This method workds similarly to <a class="reference internal" href="#jtcmake.Rule.init_deco" title="jtcmake.Rule.init_deco"><code class="xref py py-func docutils literal notranslate"><span class="pre">Rule.init_deco()</span></code></a>.
See its documentation for detail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the rule to be added</p></li>
<li><p><strong>output_files</strong> – output files of the rule.
See <a class="reference internal" href="#jtcmake.UntypedGroup.add" title="jtcmake.UntypedGroup.add"><code class="xref py py-func docutils literal notranslate"><span class="pre">add()</span></code></a> for more information.
Just like <a class="reference internal" href="#jtcmake.UntypedGroup.add" title="jtcmake.UntypedGroup.add"><code class="xref py py-func docutils literal notranslate"><span class="pre">add()</span></code></a>, file paths will be internally
converted to <a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">jtcmake.File</span></code></a> if they aren’t either
<a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">jtcmake.File</span></code></a> or <a class="reference internal" href="#jtcmake.VFile" title="jtcmake.VFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">jtcmake.VFile</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rule_method_decorator</strong>.</p>
</dd>
</dl>
<dl>
<dt>Usage:</dt><dd><p>Invoking the <code class="docutils literal notranslate"><span class="pre">rule_method_decorator</span></code> with the method you want to
bind to the new rule creates the rule and append it to this group.</p>
<p>All the arguments to the method must have a default value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">add_deco</span><span class="p">(</span><span class="s2">&quot;myrule1&quot;</span><span class="p">)(</span><span class="k">lambda</span> <span class="n">p</span><span class="o">=</span><span class="n">SELF</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">))</span>

<span class="nd">@g</span><span class="o">.</span><span class="n">add_deco</span><span class="p">(</span><span class="s2">&quot;myrule2&quot;</span><span class="p">,</span> <span class="s2">&quot;out.txt&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">method_for_myrule2</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">myrule1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dst</span><span class="o">=</span><span class="n">SELF</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">myrule2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abcabc&quot;</span>
</pre></div>
</div>
<p>The above is equivalent to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;myrule1&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">p</span><span class="o">=</span><span class="n">SELF</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">))(</span><span class="n">SELF</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">method_for_myrule2</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">myrule1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dst</span><span class="o">=</span><span class="n">SELF</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;myrule2&quot;</span><span class="p">,</span> <span class="s2">&quot;out.txt&quot;</span><span class="p">,</span> <span class="n">method_for_myrule2</span><span class="p">)(</span>
    <span class="n">g</span><span class="o">.</span><span class="n">myrule1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SELF</span><span class="p">,</span> <span class="mi">2</span>
<span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.add_group">
<span class="sig-name descname"><span class="pre">add_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_group_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">T_Child</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">T_Child</span></span></span><a class="headerlink" href="#jtcmake.UntypedGroup.add_group" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">add_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jtcmake.UntypedGroup" title="jtcmake.group_tree.groups.UntypedGroup"><span class="pre">UntypedGroup</span></a></span></span></dt>
<dd><p>Append a child group to this group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name of the new child group.</p></li>
<li><p><strong>child_group_type</strong> – class of the new child group.
If not specified, <code class="docutils literal notranslate"><span class="pre">UntypedGroup</span></code> will be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.addvf">
<span class="sig-name descname"><span class="pre">addvf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jtcmake.Rule" title="jtcmake.group_tree.rule.Rule"><span class="pre">Rule</span></a><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.UntypedGroup.addvf" title="Permalink to this definition"></a></dt>
<dd><p>Create a temporary function to add a rule to this group.</p>
<p>This method is equal to <code class="xref py py-func docutils literal notranslate"><span class="pre">self.add</span></code> except the default
file class is <a class="reference internal" href="#jtcmake.VFile" title="jtcmake.VFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">VFile</span></code></a> instead of <a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a>.</p>
<p>See the documentation of <code class="xref py py-func docutils literal notranslate"><span class="pre">self.add</span></code> for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.addvf_deco">
<span class="sig-name descname"><span class="pre">addvf_deco</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_files</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_T_deco_f</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_T_deco_f</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.UntypedGroup.addvf_deco" title="Permalink to this definition"></a></dt>
<dd><p>Create a temporary decorator function to add a rule to this group.</p>
<p>This method is equal to <a class="reference internal" href="#jtcmake.UntypedGroup.add_deco" title="jtcmake.UntypedGroup.add_deco"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_deco()</span></code></a> except the default file
constructor is <a class="reference internal" href="#jtcmake.VFile" title="jtcmake.VFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">jtcmake.VFile</span></code></a> instead of <a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a>.</p>
<p>See <a class="reference internal" href="#jtcmake.UntypedGroup.add_deco" title="jtcmake.UntypedGroup.add_deco"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_deco()</span></code></a> and <a class="reference internal" href="#jtcmake.UntypedGroup.add" title="jtcmake.UntypedGroup.add"><code class="xref py py-func docutils literal notranslate"><span class="pre">add()</span></code></a> for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#jtcmake.UntypedGroup.clean" title="Permalink to this definition"></a></dt>
<dd><p>Delete all the existing files of this group.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.groups">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">groups</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">IGroup</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jtcmake.UntypedGroup.groups" title="Permalink to this definition"></a></dt>
<dd><p>Readonly dictionary of child groups.</p>
<ul class="simple">
<li><p>Key: base name of the child group</p></li>
<li><p>Value: child group node object</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.make">
<span class="sig-name descname"><span class="pre">make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dry_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_going</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">njobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MakeSummary</span></span></span><a class="headerlink" href="#jtcmake.UntypedGroup.make" title="Permalink to this definition"></a></dt>
<dd><p>Make rules in this group and their dependencies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dry_run</strong> (<em>bool</em>) – instead of actually excuting the methods,
print expected execution logs.</p></li>
<li><p><strong>keep_going</strong> (<em>bool</em>) – If False (default), stop everything when a rule fails.
If True, when a rule fails, keep executing other rules
except the ones depend on the failed rule.</p></li>
<li><p><strong>njobs</strong> (<em>int</em>) – Maximum number of rules that can be made simultaneously using
multiple threads and processes.
Defaults to 1 (single process, single thread).</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See the description of jtcmake.make for more detail of njobs</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.prefix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prefix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#jtcmake.UntypedGroup.prefix" title="Permalink to this definition"></a></dt>
<dd><p>Path prefix of this group.</p>
<dl class="simple">
<dt>Seealso:</dt><dd><p><a class="reference internal" href="#jtcmake.UntypedGroup.set_prefix" title="jtcmake.UntypedGroup.set_prefix"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_prefix()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.rules">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rules</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jtcmake.Rule" title="jtcmake.group_tree.rule.Rule"><span class="pre">Rule</span></a><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#jtcmake.UntypedGroup.rules" title="Permalink to this definition"></a></dt>
<dd><p>Readonly dictionary of child rules.</p>
<ul class="simple">
<li><p>Key: base name of the child rule</p></li>
<li><p>Value: child rule node object</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.select_files">
<span class="sig-name descname"><span class="pre">select_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jtcmake.IFile" title="jtcmake.group_tree.core.IFile"><span class="pre">IFile</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.UntypedGroup.select_files" title="Permalink to this definition"></a></dt>
<dd><p>Create list of files in this group sub-tree that match <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.</p>
<p>This is the file-version of <a class="reference internal" href="#jtcmake.UntypedGroup.select_groups" title="jtcmake.UntypedGroup.select_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">select_groups()</span></code></a>.
See its documentation for detail.</p>
<p class="rubric">Examples</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;ROOT&gt;
|-- a(r)
|   |-- a (f:a.txt)
|   `-- b (f:b.html)
|
`-- b(g)
    `-- a(r)
        `-- a (f:a.txt)
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span><span class="p">,</span> <span class="n">SELF</span>

<span class="c1"># Building the above group tree</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">()</span>  <span class="c1"># Root group</span>
<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;a.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="s2">&quot;b.html&quot;</span> <span class="p">},</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">SELF</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;a.txt&quot;</span> <span class="p">},</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_files</span><span class="p">(</span><span class="s2">&quot;**/a&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">a</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_files</span><span class="p">(</span><span class="s2">&quot;a/*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">b</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.select_groups">
<span class="sig-name descname"><span class="pre">select_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">IGroup</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.UntypedGroup.select_groups" title="Permalink to this definition"></a></dt>
<dd><p>Create list of groups in this group sub-tree that match <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.
The list may include this group itself.</p>
<p>Groups are gathered based on the given pattern in a manner similar to
how we specify a set of files using a glob pattern on Unix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pattern</strong> – <p>str or list/tuple of str representing a pattern of
relative names of offspring nodes.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">pattern</span></code> is a list/tuple of strs,
it must be a sequence of <em>base name patterns</em> like
<code class="docutils literal notranslate"><span class="pre">[&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;]</span></code> or <code class="docutils literal notranslate"><span class="pre">[&quot;a&quot;,</span> <span class="pre">&quot;*b*&quot;,</span> <span class="pre">&quot;c&quot;,</span> <span class="pre">&quot;**&quot;]</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">pattern</span></code> is a str, it will be internally translated into
an equivalent list-of-str pattern by splitting it with <code class="docutils literal notranslate"><span class="pre">/</span></code>.
So, for example, <code class="docutils literal notranslate"><span class="pre">g.select_groups(&quot;a/b/c&quot;)</span> <span class="pre">is</span> <span class="pre">equivalent</span> <span class="pre">to</span>
<span class="pre">``g.select_groups([&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;])</span></code>.</p>
</p>
</dd>
</dl>
<p>Suppose we have the following group tree (the tree may have rules as
well but we omit them since this method collects groups only).</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;ROOT&gt;
|
|-- a1
|   |-- b1
|   `-- b2
|       `-- c1
|
|-- a2
|   `-- b1
|
`-- a1/b1
</pre></div>
</div>
<p>We use a list of strs to identify each group node.
For example, the (absolute) name of the forth group from the top
(the deepest one) is <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;,</span> <span class="pre">&quot;b2&quot;,</span> <span class="pre">&quot;c1&quot;]</span></code>.
Its <em>relative name</em> with respect to the group <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;]</span></code> is
<code class="docutils literal notranslate"><span class="pre">[&quot;b2&quot;,</span> <span class="pre">&quot;c1&quot;]</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;c1&quot;</span></code> is its <em>base name</em>.</p>
<p>Pattern matching is basically as simple as <em>pattern</em> <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;,</span> <span class="pre">&quot;b1&quot;]</span></code>
matches the <em>relative name</em> <code class="docutils literal notranslate"><span class="pre">[&quot;a1&quot;,</span> <span class="pre">&quot;b1&quot;]</span></code>.
Additionally, you can use wildcard <code class="docutils literal notranslate"><span class="pre">*</span></code> in patterns as follows.</p>
<ul class="simple">
<li><p>Double stars <code class="docutils literal notranslate"><span class="pre">**</span></code> can appear as a special base name indicating
zero or more repetition of arbitrary base names.
It may NOT appear inside a base name like <code class="docutils literal notranslate"><span class="pre">a/**b/c</span></code></p></li>
<li><p>Single stars <code class="docutils literal notranslate"><span class="pre">*</span></code> can appear inside a base name indicating zero
or more repetition of arbitrary character.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span>

<span class="c1"># Building the above group tree</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">()</span>  <span class="c1"># Root group</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b2&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;c1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a2&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;b1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">([</span><span class="s2">&quot;a1&quot;</span><span class="p">,</span> <span class="s2">&quot;b1&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">]</span>

<span class="c1"># In the following example,  ``/`` in the base name is treated</span>
<span class="c1"># as a normal character and has no effect as a base name boundary</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">([</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">]]</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;a*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">]]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;*/*1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">b1</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;**/*1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">c1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">]</span>
<span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;**&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span>
    <span class="n">g</span><span class="p">,</span>  <span class="c1"># root is included</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">c1</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span>
    <span class="n">g</span><span class="o">.</span><span class="n">a2</span><span class="o">.</span><span class="n">b1</span><span class="p">,</span>
    <span class="n">g</span><span class="p">[</span><span class="s2">&quot;a1/b1&quot;</span><span class="p">],</span>
<span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">select_groups</span><span class="p">(</span><span class="s2">&quot;a1/*&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Current implementation collects nodes using pre-order DFS but
it may be changed in the future.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.select_rules">
<span class="sig-name descname"><span class="pre">select_rules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">IRule</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.UntypedGroup.select_rules" title="Permalink to this definition"></a></dt>
<dd><p>Create list of rules in this group sub-tree that match <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.</p>
<p>This is the rule-version of <a class="reference internal" href="#jtcmake.UntypedGroup.select_groups" title="jtcmake.UntypedGroup.select_groups"><code class="xref py py-func docutils literal notranslate"><span class="pre">select_groups()</span></code></a>.
See its documentation for detail.</p>
<p class="rubric">Examples</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;ROOT&gt;
|-- a0(r)
|-- a1
|   `-- a2(r)
`-- a3
    `-- a4(r)
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span><span class="p">,</span> <span class="n">SELF</span>

<span class="c1"># Building the above group tree</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">()</span>  <span class="c1"># Root group</span>
<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a0&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a1&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a2&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;a3&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;a4&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">())(</span><span class="n">SELF</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_rules</span><span class="p">(</span><span class="s2">&quot;a*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a0</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">select_rules</span><span class="p">(</span><span class="s2">&quot;*/a*&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">a1</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a3</span><span class="o">.</span><span class="n">a4</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.set_prefix">
<span class="sig-name descname"><span class="pre">set_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">T_Self</span></span></span><a class="headerlink" href="#jtcmake.UntypedGroup.set_prefix" title="Permalink to this definition"></a></dt>
<dd><p>Set the path prefix of this group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dirname</strong> – if specified, prefix will be <code class="docutils literal notranslate"><span class="pre">dirname</span> <span class="pre">+</span> <span class="pre">&quot;/&quot;</span></code></p></li>
<li><p><strong>prefix</strong> – path prefix.</p></li>
</ul>
</dd>
</dl>
<p>You must specify either but not both of <code class="docutils literal notranslate"><span class="pre">dirname</span></code> or <code class="docutils literal notranslate"><span class="pre">prefix</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">self.set_prefix(&quot;a&quot;)</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">self.set_prefix(prefix=&quot;a/&quot;)</span></code>.</p>
<p>If this group is not the root group and the given prefix is a
relative path, the path prefix of the parent group will be added to
its start. Absolute paths do not undergo this prefixing.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method may be called only when the prefix is not yet
determined. i.e. You may NOT call this method whenever,</p>
<ul class="simple">
<li><p>You have created this group as a root group</p></li>
<li><p>You have once called it</p></li>
<li><p>You have once read <a class="reference internal" href="#jtcmake.UntypedGroup.prefix" title="jtcmake.UntypedGroup.prefix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">self.prefix</span></code></a>:
reading <a class="reference internal" href="#jtcmake.UntypedGroup.prefix" title="jtcmake.UntypedGroup.prefix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">self.prefix</span></code></a> internally finalizes
the prefix to <code class="docutils literal notranslate"><span class="pre">&quot;{name</span> <span class="pre">of</span> <span class="pre">this</span> <span class="pre">group}/&quot;</span></code></p></li>
<li><p>You have once read the prefix of a child group:
reading a child’s prefix internally reads the parent’s prefix</p></li>
<li><p>You have initialized any rule in the sub-tree:
initializing a rule internally reads its parent’s prefix</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># (For Unix only)</span>

<span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">UntypedGroup</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">UntypedGroup</span><span class="p">(</span><span class="s2">&quot;root&quot;</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_prefix</span><span class="p">(</span><span class="s2">&quot;foo-dir&quot;</span><span class="p">)</span>  <span class="c1"># dirname</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;bar-&quot;</span><span class="p">)</span>  <span class="c1"># prefix</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;baz&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_prefix</span><span class="p">(</span><span class="s2">&quot;/tmp/baz&quot;</span><span class="p">)</span>  <span class="c1"># dirname abspath</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="s2">&quot;qux&quot;</span><span class="p">)</span>  <span class="c1"># no explicit setting</span>

<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/foo-dir/&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/bar-&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">baz</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;/tmp/baz/&quot;</span>
<span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">qux</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;root/qux/&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.UntypedGroup.touch">
<span class="sig-name descname"><span class="pre">touch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#jtcmake.UntypedGroup.touch" title="Permalink to this definition"></a></dt>
<dd><p>For every rule in the group, touch (set mtime to now) the output files
and force the memo to record the current input state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>bool</em>) – if False, files won’t be touched. Defaults to True.</p></li>
<li><p><strong>memo</strong> (<em>bool</em>) – if False, memos won’t be modified. Defaults to True.</p></li>
<li><p><strong>create</strong> (<em>bool</em>) – if True, missing files will be created. Otherwise,
only the existing files will be touched.
This option has no effect with <code class="docutils literal notranslate"><span class="pre">file=False</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jtcmake.Rule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jtcmake.</span></span><span class="sig-name descname"><span class="pre">Rule</span></span><a class="headerlink" href="#jtcmake.Rule" title="Permalink to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="jtcmake.Rule.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#jtcmake.Rule.clean" title="Permalink to this definition"></a></dt>
<dd><p>Delete all the existing files of this rule.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.Rule.files">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">files</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">T</span></em><a class="headerlink" href="#jtcmake.Rule.files" title="Permalink to this definition"></a></dt>
<dd><p>Readonly dictionary of output files.</p>
<ul class="simple">
<li><p>Key: file key of the file</p></li>
<li><p>Value: <a class="reference internal" href="#jtcmake.IFile" title="jtcmake.IFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">jtcmake.IFile</span></code></a> object</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.Rule.init">
<span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">P</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">P</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jtcmake.Rule" title="jtcmake.group_tree.rule.Rule"><span class="pre">Rule</span></a><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.Rule.init" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_files</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">P</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">P</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jtcmake.Rule" title="jtcmake.group_tree.rule.Rule"><span class="pre">Rule</span></a><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Create a temporary function to complete initialization of this rule.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method must be called only for <em>uninitialized rules</em> which
do not have the output files, method, and method’s arguments
assigned to themselvs yet.</p>
<p>For example, you have to call this method for rules of
<a class="reference internal" href="#jtcmake.StaticGroupBase" title="jtcmake.StaticGroupBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">StaticGroupBase</span></code></a>-like groups while you must not for rules
owned by <a class="reference internal" href="#jtcmake.RulesGroup" title="jtcmake.RulesGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">RulesGroup</span></code></a> groups.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_files</strong> – <p>if not specified, this rule’s name will be used.
The following three forms are accepted.</p>
<ul>
<li><p><strong>Dict</strong> (<code class="docutils literal notranslate"><span class="pre">{&quot;key1&quot;:</span> <span class="pre">file1,</span> <span class="pre">&quot;key2&quot;:</span> <span class="pre">file2,</span> <span class="pre">...}</span></code>):
<code class="docutils literal notranslate"><span class="pre">key1</span></code>, <code class="docutils literal notranslate"><span class="pre">key2</span></code>, … are the <em>file keys</em> and <code class="docutils literal notranslate"><span class="pre">file1</span></code>,
<code class="docutils literal notranslate"><span class="pre">file2</span></code>, … are the <em>file paths</em>.</p></li>
<li><p><strong>List</strong> (<code class="docutils literal notranslate"><span class="pre">[file1,</span> <span class="pre">file2,</span> <span class="pre">...]</span></code>):
equivalent to a dict-form of
<code class="docutils literal notranslate"><span class="pre">{str(file1):</span> <span class="pre">file1,</span> <span class="pre">str(file2):</span> <span class="pre">file2}</span></code></p></li>
<li><p><strong>Atom</strong> (<code class="docutils literal notranslate"><span class="pre">file</span></code>):
equivalent to a dict-form of <code class="docutils literal notranslate"><span class="pre">{str(file):</span> <span class="pre">file}</span></code></p></li>
</ul>
<p><em>File keys</em> must be str. <em>File paths</em> may be either str or
PathLike including <a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a> and
<a class="reference internal" href="#jtcmake.VFile" title="jtcmake.VFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">VFile</span></code></a>.
If a given file path is neither <a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a> or
<a class="reference internal" href="#jtcmake.VFile" title="jtcmake.VFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">VFile</span></code></a>, it will be converted to <a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a> by
<code class="docutils literal notranslate"><span class="pre">File(file_path)</span></code>.</p>
</p></li>
<li><p><strong>method</strong> – function to create the output files</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>rule_initializer</strong>, a temporary function whose signature is the
same as the given <code class="docutils literal notranslate"><span class="pre">method</span></code>.
Calling it as <code class="docutils literal notranslate"><span class="pre">rule_adder(*args,</span> <span class="pre">**kwargs)</span></code> completes
initialization of this rule.</p>
<p>While executing this rule, <code class="docutils literal notranslate"><span class="pre">method</span></code> is called as
<code class="docutils literal notranslate"><span class="pre">method(*args,</span> <span class="pre">**kwargs)</span></code>.</p>
</p>
</dd>
</dl>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p><strong>Name Reference in File Paths</strong></p>
<p>A file path in a dict-form <code class="docutils literal notranslate"><span class="pre">output_files</span></code> may contain text
symbols <code class="docutils literal notranslate"><span class="pre">&quot;&lt;R&gt;&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;&lt;F&gt;&quot;</span></code>, which will be replaced with
the rule’s name and the corresponding file key, respectively.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">output_files={</span> <span class="pre">&quot;foo&quot;:</span> <span class="pre">Path(&quot;&lt;R&gt;-&lt;F&gt;.txt&quot;)</span> <span class="pre">}</span></code>
for a rule named “myrule” is equivalent to
<code class="docutils literal notranslate"><span class="pre">output_files={</span> <span class="pre">&quot;foo&quot;:</span> <span class="pre">Path(&quot;myrule-foo.txt&quot;)</span> <span class="pre">}</span></code>.</p>
<p>In list/atom form of <code class="docutils literal notranslate"><span class="pre">output_files</span></code>, you may use <code class="docutils literal notranslate"><span class="pre">&lt;R&gt;</span></code> too
but <code class="docutils literal notranslate"><span class="pre">&lt;F&gt;</span></code> is not allowed because the file keys are derived
from the file paths.</p>
<p><strong>Path Prefixing</strong></p>
<p>If given as a relative path, file paths get transformed by adding
the parent group’s <em>path prefix</em> to the head.</p>
<p>For example, if the parent group’s path prefix is
<code class="docutils literal notranslate"><span class="pre">&quot;output_dir/&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">output_files</span></code> of <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;a&quot;:</span> <span class="pre">File(&quot;a.txt&quot;)</span> <span class="pre">}</span></code>
will be transformed into <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;a&quot;:</span> <span class="pre">File(&quot;out/a.txt&quot;)</span> <span class="pre">}</span></code>.</p>
<p>You can suppress this conversion by passing the path as an absolute
path.</p>
<p><strong>Rule-initializer and Argument Substitution</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">Rule.init(output_files,</span> <span class="pre">method)</span></code> returns a temporary function,
<strong>rule_initializer</strong> and you must further call it with the
arguments to be eventually passed to <code class="docutils literal notranslate"><span class="pre">method</span></code> like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">rule</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">output_files</span><span class="p">,</span> <span class="n">method</span><span class="p">)(</span><span class="n">SELF</span><span class="p">,</span> <span class="n">foo</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p class="rubric">Examples</p>
<p>Basic usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Literal</span>
<span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">StaticGroupBase</span><span class="p">,</span> <span class="n">Rule</span><span class="p">,</span> <span class="n">SELF</span>

<span class="k">def</span> <span class="nf">split_write</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file1</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">file2</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
    <span class="c1"># Write first half of ``text`` to file1 and the rest to file2</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">file1</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span><span class="p">[:</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">file2</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span> <span class="n">n</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">cat</span><span class="p">(</span><span class="n">dst</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="o">*</span><span class="n">srcs</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">dst</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">srcs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MyGroup</span><span class="p">(</span><span class="n">StaticGroupBase</span><span class="p">):</span>
    <span class="vm">__globals__</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span>  <span class="c1"># Only for Sphinx&#39;s doctest. Not necessary in normal situations.</span>
    <span class="n">foo</span><span class="p">:</span> <span class="n">Rule</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]]</span>
    <span class="n">bar</span><span class="p">:</span> <span class="n">Rule</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">buz</span><span class="p">:</span> <span class="n">Rule</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MyGroup</span><span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Supplying keys other than &quot;a&quot; and &quot;b&quot; would be marked as</span>
<span class="sd">        a type error by type checkers such as Mypy and Pyright.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">init</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;a.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="s2">&quot;b.txt&quot;</span><span class="p">},</span> <span class="n">split_write</span><span class="p">)(</span>
            <span class="s2">&quot;abcd&quot;</span><span class="p">,</span> <span class="n">SELF</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SELF</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        The list below will be translated into `{&quot;x.txt&quot;: &quot;x.txt&quot;, &quot;y.txt&quot;: &quot;y.txt&quot;}`</span>
<span class="sd">        (and then `{&quot;x.txt&quot;: File(&quot;out/x.txt&quot;), &quot;y.txt&quot;: File(&quot;out/y.txt&quot;}`)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">init</span><span class="p">([</span><span class="s2">&quot;x.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;y.txt&quot;</span><span class="p">],</span> <span class="n">split_write</span><span class="p">)(</span>
            <span class="s2">&quot;efgh&quot;</span><span class="p">,</span> <span class="n">file1</span><span class="o">=</span><span class="n">SELF</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">file2</span><span class="o">=</span><span class="n">SELF</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># you can use keyword args</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">buz</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;w.txt&quot;</span><span class="p">,</span> <span class="n">cat</span><span class="p">)(</span>
            <span class="n">SELF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">foo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">foo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">bar</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">bar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">MyGroup</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

<span class="n">g</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/a.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;ab&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/b.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;cd&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/x.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;ef&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/y.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;gh&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/w.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abcdefgh&quot;</span>

<span class="kn">import</span> <span class="nn">shutil</span><span class="p">;</span> <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>  <span class="c1"># Cleanup for Sphinx&#39;s doctest</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.Rule.init_deco">
<span class="sig-name descname"><span class="pre">init_deco</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_files</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_T_deco_f</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_T_deco_f</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.Rule.init_deco" title="Permalink to this definition"></a></dt>
<dd><p>Create a temporary decorator function to initialize this rule.
This is a decorator version of <a class="reference internal" href="#jtcmake.Rule.init" title="jtcmake.Rule.init"><code class="xref py py-func docutils literal notranslate"><span class="pre">init()</span></code></a>.
This is useful when you want to define a method for the rule
on-the-fly instead of passing an existing function
(see the examples below).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>output_files</strong> – <p>output files of this rule.
If not specified, this rule’s name will be used.
Just like <a class="reference internal" href="#jtcmake.Rule.init" title="jtcmake.Rule.init"><code class="xref py py-func docutils literal notranslate"><span class="pre">init()</span></code></a>, file paths will be internally converted
to <a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a> if they aren’t either <a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a> or
<a class="reference internal" href="#jtcmake.VFile" title="jtcmake.VFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">VFile</span></code></a>.</p>
<p>See <a class="reference internal" href="#jtcmake.Rule.init" title="jtcmake.Rule.init"><code class="xref py py-func docutils literal notranslate"><span class="pre">init()</span></code></a> for more information.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>rule_method_decorator</strong>.</p>
<p>Invoking the <code class="docutils literal notranslate"><span class="pre">rule_method_decorator</span></code> with the method you want to
bind to this rule completes initialization of the rule.</p>
<p>All the arguments to the method must have a default value
(see the example).</p>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jtcmake</span> <span class="kn">import</span> <span class="n">StaticGroupBase</span><span class="p">,</span> <span class="n">Rule</span><span class="p">,</span> <span class="n">SELF</span>

<span class="k">class</span> <span class="nc">MyGroup</span><span class="p">(</span><span class="n">StaticGroupBase</span><span class="p">):</span>
    <span class="vm">__globals__</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span>  <span class="c1"># Only for Sphinx&#39;s doctest. Not necessary in normal situations.</span>
    <span class="n">rule1</span><span class="p">:</span> <span class="n">Rule</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">rule2</span><span class="p">:</span> <span class="n">Rule</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">repeat</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MyGroup</span><span class="p">:</span>
        <span class="nd">@self</span><span class="o">.</span><span class="n">rule1</span><span class="o">.</span><span class="n">init_deco</span><span class="p">(</span><span class="s2">&quot;&lt;R&gt;.txt&quot;</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">method_for_rule1</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">SELF</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">):</span>
            <span class="n">path</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="nd">@self</span><span class="o">.</span><span class="n">rule2</span><span class="o">.</span><span class="n">init_deco</span><span class="p">(</span><span class="s2">&quot;&lt;R&gt;.txt&quot;</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">method_for_rule2</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rule1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dst</span><span class="o">=</span><span class="n">SELF</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="n">repeat</span><span class="p">):</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
            <span class="n">dst</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span> <span class="o">*</span> <span class="n">repeat</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>


<span class="n">MyGroup</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/rule1.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abc&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/rule2.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abcabc&quot;</span>

<span class="n">MyGroup</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/rule1.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abc&quot;</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;out/rule2.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;abcabcabc&quot;</span>

<span class="kn">import</span> <span class="nn">shutil</span><span class="p">;</span> <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>  <span class="c1"># Cleanup for Sphinx&#39;s doctest</span>
</pre></div>
</div>
<dl class="simple">
<dt>Seealso:</dt><dd><p><a class="reference internal" href="#jtcmake.Rule.init" title="jtcmake.Rule.init"><code class="xref py py-func docutils literal notranslate"><span class="pre">init()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.Rule.initvf">
<span class="sig-name descname"><span class="pre">initvf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">P</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">P</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jtcmake.Rule" title="jtcmake.group_tree.rule.Rule"><span class="pre">Rule</span></a><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.Rule.initvf" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">initvf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_files</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">P</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">P</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jtcmake.Rule" title="jtcmake.group_tree.rule.Rule"><span class="pre">Rule</span></a><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Create a temporary function to initialize this rule.</p>
<p>This method is equal to <a class="reference internal" href="#jtcmake.Rule.init" title="jtcmake.Rule.init"><code class="xref py py-func docutils literal notranslate"><span class="pre">init()</span></code></a> except the default class
constructor is <a class="reference internal" href="#jtcmake.VFile" title="jtcmake.VFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">VFile</span></code></a> instead of <a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a>.</p>
<dl class="simple">
<dt>Seealso:</dt><dd><p><a class="reference internal" href="#jtcmake.Rule.init" title="jtcmake.Rule.init"><code class="xref py py-func docutils literal notranslate"><span class="pre">init()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.Rule.initvf_deco">
<span class="sig-name descname"><span class="pre">initvf_deco</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_files</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_T_deco_f</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_T_deco_f</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#jtcmake.Rule.initvf_deco" title="Permalink to this definition"></a></dt>
<dd><p>Create a temporary decorator function to initialize this rule.</p>
<p>This method is equal to <a class="reference internal" href="#jtcmake.Rule.init_deco" title="jtcmake.Rule.init_deco"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_deco()</span></code></a> except the default class
constructor is <a class="reference internal" href="#jtcmake.VFile" title="jtcmake.VFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">VFile</span></code></a> instead of <a class="reference internal" href="#jtcmake.File" title="jtcmake.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a>.</p>
<dl class="simple">
<dt>Seealso:</dt><dd><p><a class="reference internal" href="#jtcmake.Rule.init_deco" title="jtcmake.Rule.init_deco"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_deco()</span></code></a>, <a class="reference internal" href="#jtcmake.Rule.init" title="jtcmake.Rule.init"><code class="xref py py-func docutils literal notranslate"><span class="pre">init()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jtcmake.Rule.touch">
<span class="sig-name descname"><span class="pre">touch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#jtcmake.Rule.touch" title="Permalink to this definition"></a></dt>
<dd><p>Touch (set mtime to now) the output files and force the memo to record
the current input state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>bool</em>) – if False, the output files won’t be touched. Defaults to True.</p></li>
<li><p><strong>memo</strong> (<em>bool</em>) – if False, the memo won’t be modified. Defaults to True.</p></li>
<li><p><strong>create</strong> (<em>bool</em>) – if True, missing files will be created.
Otherwise, only the existing files will be touched.
This option has no effect with <code class="docutils literal notranslate"><span class="pre">file=False</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jtcmake.Rule.xfiles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xfiles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">T</span></em><a class="headerlink" href="#jtcmake.Rule.xfiles" title="Permalink to this definition"></a></dt>
<dd><p>List of path of the input files.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jtcmake.File">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jtcmake.</span></span><span class="sig-name descname"><span class="pre">File</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jtcmake.File" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">PosixPath</span></code>, <a class="reference internal" href="#jtcmake.IFile" title="jtcmake.group_tree.core.IFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">IFile</span></code></a></p>
<p>An instance of this class represents a file, which can be an input or
output of rules.</p>
<p>When used as an input, on judging whether the rule must be updated,
its modification time is compared to the modification time of the
output files.
If any of the output files is older than the input, the rule must be
updated.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jtcmake.VFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jtcmake.</span></span><span class="sig-name descname"><span class="pre">VFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jtcmake.VFile" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">PosixPath</span></code>, <a class="reference internal" href="#jtcmake.IFile" title="jtcmake.group_tree.core.IFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">IFile</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">IMemoAtom</span></code></p>
<p>An instance of this class represents a value file, which can be
an input or output of rules.</p>
<p>When used as an input, on judging whether the rule must be updated,
its modification time is compared to the modification time of the
output files.
If any of the output files is older than the input, the rule must be
updated.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jtcmake.IFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jtcmake.</span></span><span class="sig-name descname"><span class="pre">IFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jtcmake.IFile" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">IAtom</span></code></p>
<p>Abstract base class to represent a file object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jtcmake.make">
<span class="sig-prename descclassname"><span class="pre">jtcmake.</span></span><span class="sig-name descname"><span class="pre">make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">rule_or_groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">IGroup</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">IRule</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dry_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_going</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">njobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MakeSummary</span></span></span><a class="headerlink" href="#jtcmake.make" title="Permalink to this definition"></a></dt>
<dd><p>make rules</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rules_or_groups</strong> (<em>Sequence</em><em>[</em><em>RuleNodeBase</em><em>|</em><em>Group</em><em>]</em>) – Rules and Groups containing target Rules</p></li>
<li><p><strong>dry_run</strong> – instead of actually excuting methods, print expected execution logs.</p></li>
<li><p><strong>keep_going</strong> – If False (default), stop everything when a rule fails.
If True, when a rule fails, keep executing other rules
except the ones depend on the failed rule.</p></li>
<li><p><strong>njobs</strong> – Maximum number of rules that can be made concurrently.
Defaults to 1 (single process, single thread).</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Safely and effectively using njobs &gt;= 2 require a certain level of
understanding of Python’s threading and multiprocessing and their
complications.</p>
<p>Only <em>inter-process transferable</em> rules are executed on child processes.
Other rules are executed on threads of the main process, thus
subject to the constraints of global interpreter lock (GIL).</p>
<p><em>inter-process transferable</em> means being able to be sent to a child
process without errors.</p>
<p>Child processes are started by the ‘spawn’ method, not ‘fork’,
even on Linux systems.</p>
<p>njobs &gt;= 2 may not work on interactive interpreters.
It should work on Jupyter Notebook/Lab but any function or class
that are defined on the notebook is not inter-process transferable.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jtcmake.print_graphviz">
<span class="sig-prename descclassname"><span class="pre">jtcmake.</span></span><span class="sig-name descname"><span class="pre">print_graphviz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">IGroup</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">IRule</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">jtcmake.group_tree.core.IGroup</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jtcmake.group_tree.core.IRule</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dependency_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rankdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'TD'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'LR'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'LR'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jtcmake.print_graphviz" title="Permalink to this definition"></a></dt>
<dd><p>Visualize the dependency graph using Graphviz.
Graphviz binaries are required to be available in PATH.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> – Group node whose Rules will be visualized</p></li>
<li><p><strong>output_file</strong> – <p>If specified, graph will be written into the file.
Otherwise, graph will be printed to the terminal (available on
Jupyter only). Graph format depends on the file extension:</p>
<ul>
<li><p>.svg: SVG</p></li>
<li><p>.htm or .html: HTML (SVG image embedded)</p></li>
<li><p>.dot: Graphviz’s DOT code (text)</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="howto.html" class="btn btn-neutral float-left" title="JTCMake Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Amane Sugiyama.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>